{"version":3,"file":"bundle.js","sources":["/Users/michaelhayes/work/altr/node_modules/browserify/node_modules/browser-pack/_prelude.js","/Users/michaelhayes/work/altr/lib/browser.js","/Users/michaelhayes/work/altr/lib/index.js","/Users/michaelhayes/work/altr/lib/tags/placeholder.js","/Users/michaelhayes/work/altr/lib/tags/children.js","/Users/michaelhayes/work/altr/lib/tags/include.js","/Users/michaelhayes/work/altr/lib/tags/text.js","/Users/michaelhayes/work/altr/lib/tags/html.js","/Users/michaelhayes/work/altr/lib/tags/with.js","/Users/michaelhayes/work/altr/lib/tags/for.js","/Users/michaelhayes/work/altr/lib/tags/if.js","/Users/michaelhayes/work/altr/lib/altr.js","/Users/michaelhayes/work/altr/lib/template-string.js","/Users/michaelhayes/work/altr/lib/element-node.js","/Users/michaelhayes/work/altr/lib/merge-hooks.js","/Users/michaelhayes/work/altr/lib/text-node.js","/Users/michaelhayes/work/altr/lib/to-string.js","/Users/michaelhayes/work/altr/lib/get-element.js","/Users/michaelhayes/work/altr/lib/replace.js","/Users/michaelhayes/work/altr/lib/render.js","/Users/michaelhayes/work/altr/lib/insert.js","/Users/michaelhayes/work/altr/lib/remove.js","/Users/michaelhayes/work/altr/lib/raf.js","/Users/michaelhayes/work/altr/lib/set-children.js","/Users/michaelhayes/work/altr/node_modules/browserify/node_modules/events/events.js","/Users/michaelhayes/work/altr/lib/directives.js","/Users/michaelhayes/work/altr/lib/attributes.js","/Users/michaelhayes/work/altr/node_modules/batch-queue/index.js","/Users/michaelhayes/work/altr/node_modules/dirtybit/lib/index.js","/Users/michaelhayes/work/altr/node_modules/dirtybit/lib/types/operators.js","/Users/michaelhayes/work/altr/node_modules/dirtybit/lib/types/brackets.js","/Users/michaelhayes/work/altr/node_modules/dirtybit/lib/types/dot-path.js","/Users/michaelhayes/work/altr/node_modules/dirtybit/lib/types/filters.js","/Users/michaelhayes/work/altr/node_modules/dirtybit/lib/types/partial.js","/Users/michaelhayes/work/altr/node_modules/dirtybit/lib/types/parens.js","/Users/michaelhayes/work/altr/node_modules/dirtybit/lib/types/values.js","/Users/michaelhayes/work/altr/node_modules/dirtybit/lib/split.js","/Users/michaelhayes/work/altr/node_modules/dirtybit/lib/list.js"],"names":["module","exports","global","altr","require","placeholder","childrenTag","includeTag","textTag","htmlTag","withTag","forTag","ifTag","addTag","original","getter","lookups","update","val","nodeName","current","replace","parentNode","_altrPlaceholder","this","batch","add","register","children","el","nodes","Array","isArray","filter","is_node","i","l","length","setChildren","call","innerHTML","bind","nodeType","include","name","includes","initNodes","childNodes","text","textContent","html","accessor","getAttribute","forEach","getElementsByTagName","run","script","fixed","document","createElement","parent","attrs","attributes","setAttribute","value","insertBefore","removeChild","_val","Object","create","state","parts","split","hooks","forHandler","root","args","updateChildren","data","itemData","prop","items","destroy","runDestroy","newItems","index","newChildren","matched","domNodes","findIndex","unique","makeChild","concat","slice","runUpdates","d","indexOf","temp","createElementNS","namespaceURI","template","prototype","runDomUpdates","list","match","for_regexp","Error","key","toggle","show","hide","createComment","hidden","sync","doc","EE","domModule","filters","directives","dirtybit","raf","runBatch","Buffer","toString","createDocumentFragment","firstChild","appendChild","rootNodes","emit","_lookups","map","initNode","Boolean","reduce","mergeHooks","node_handlers","root_nodes","DOCUMENT_FRAGMENT_NODE","addFilter","attr","tag","tags","tagList","push","constructor","appendTo","node","getEl","fn","addDirective","EventEmitter","templateString","elementNode","textNode","render","insert","remove","getElement","into","templatString","change","setPart","idx","join","TAG","next","remaining","createElementNode","altr_tags","updates","lastIndexOf","createAttr","raw","createDirectives","merge","_lhs","_rhs","type","out","lhs","rhs","types","arrayify","keys","obj","initTextNode","clone","cloneNode","COMMENT_NODE","TEXT_NODE","outerHTML","get","_el","old","replaceChild","instance","before","inserted","nextSibling","requestAnimationFrame","callback","timeout","setTimeout","webkitRequestAnimationFrame","mozRequestAnimationFrame","prev","_events","_maxListeners","undefined","isFunction","arg","isNumber","isObject","isUndefined","defaultMaxListeners","setMaxListeners","n","isNaN","TypeError","er","handler","len","listeners","error","arguments","apply","addListener","listener","m","newListener","warned","console","trace","on","once","g","removeListener","fired","position","splice","removeAllListeners","ret","listenerCount","emitter","create_directive","self","rawAttribute","altrAttribute","removeAttribute","altrProperty","Batch","ready","all","jobs","queud","queue","queued","DirtyBit","_options","options","events","deps","values","always","getters","updating","rootKey","Infinity","_lookup","dep_of","_first","first","lookup","clean","watch","deregister","names","registerList","updateValue","trim","str","cleaned_on","hash","charCodeAt","operators","brackets","dot_path","partial","parens","operator","test","create_ternary","update_ok","ok","update_left","left","update_right","right","rest","binary","RegExp","create_binary","updaters","Function","unary","regex","create_unary","update_in","update_instanceof","ternary_regexp","update_inner","inner","update_root","has_bracket","pairs","pair","reverse","valid_path","create_filter","notify","filter_regexp","regexp","create_parens","parens_regexp","body","count","patched","create_value","vals","hasOwnProperty","number_regexp","string_regexp","true","false","null","_pairs","default_pairs","inString","layers","j","l2","pop"],"mappings":"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","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error(\"Cannot find module '\"+o+\"'\")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","module.exports = global.altr = require('./index')\n","var placeholder = require('./tags/placeholder')\n  , childrenTag = require('./tags/children')\n  , includeTag = require('./tags/include')\n  , textTag = require('./tags/text')\n  , htmlTag = require('./tags/html')\n  , withTag = require('./tags/with')\n  , forTag = require('./tags/for')\n  , ifTag = require('./tags/if')\n  , altr = require('./altr')\n\nmodule.exports = altr\n\naltr.addTag('altr-placeholder', placeholder)\naltr.addTag('altr-children', childrenTag)\naltr.addTag('altr-replace', placeholder)\naltr.addTag('altr-include', includeTag)\naltr.addTag('altr-text', textTag)\naltr.addTag('altr-html', htmlTag)\naltr.addTag('altr-with', withTag)\naltr.addTag('altr-for', forTag)\naltr.addTag('altr-if', ifTag)\n","module.exports = placeholder\n\nfunction placeholder(original, getter, lookups) {\n  var current = original\n    , altr = this\n\n  this.batch.add(lookups.register(getter, update))\n\n  function update(val) {\n    if(!val || !val.nodeName || val === current) {\n      return\n    }\n\n    altr.replace(current.parentNode, val, current)\n    original._altrPlaceholder = val\n    current = val\n  }\n}\n","var setChildren = require('../set-children')\n\nmodule.exports = children\n\nfunction children(el, getter, lookups) {\n  var current = []\n\n  el.innerHTML = ''\n  this.batch.add(lookups.register(getter, update.bind(this)))\n\n  function update(val) {\n    var nodes = (Array.isArray(val) ? val : [val]).filter(is_node)\n\n    for(var i = 0, l = nodes.length; i < l; ++i) {\n      if(nodes[i] !== current[i]) {\n        break\n      }\n    }\n\n    if(i === nodes.length === current.length) {\n      return\n    }\n\n    current = nodes\n    setChildren.call(this, el, current)\n  }\n}\n\nfunction is_node(el) {\n  return el && el.nodeType\n}\n","module.exports = include\n\nfunction include(el, name, lookups) {\n  el.innerHTML = this.includes[name]\n\n  return this.initNodes(el.childNodes, lookups)\n}\n","module.exports = text\n\nfunction text(el, getter, lookups) {\n  this.batch.add(lookups.register(getter, update))\n\n  function update(val) {\n    el.textContent = typeof val === 'undefined' ? '' : val\n  }\n}\n","module.exports = html\n\nfunction html(el, accessor, lookups) {\n  this.batch.add(lookups.register(accessor, update, lookups))\n\n  function update(val) {\n    el.innerHTML = typeof val === 'undefined' ? '' : val\n\n    if(el.getAttribute('altr-run-scripts')) {\n      [].forEach.call(el.getElementsByTagName('script'), run)\n    }\n  }\n}\n\nfunction run(script) {\n  var fixed = document.createElement('script')\n    , parent = script.parentNode\n    , attrs = script.attributes\n    , src\n\n  for(var i = 0, l = attrs.length; i < l; ++i) {\n    fixed.setAttribute(attrs[i].name, attrs[i].value)\n  }\n\n  fixed.textContent = script.textContent\n  parent.insertBefore(fixed, script)\n  parent.removeChild(script)\n}\n","module.exports = withTag\n\nfunction withTag(el, getter, lookups) {\n  var children = this.initNodes(el.childNodes)\n    , parts = getter.split(' as ')\n\n  lookups.register(parts[0], update)\n\n  return children.hooks\n\n  function update(_val) {\n    var val = Object.create(lookups.state)\n\n    val[parts[1]] = _val\n    children.lookups.update(val)\n  }\n}\n","var setChildren = require('../set-children')\n  , for_regexp = /^(.*?)\\s+in\\s+(.*$)/\n\nmodule.exports = forHandler\n\nfunction forHandler(root, args, lookups) {\n  var parts = args.match(for_regexp)\n    , template = root.innerHTML\n    , domNodes = []\n    , children = []\n    , altr = this\n    , items = []\n\n  if(!parts) {\n    throw new Error('invalid for tag: ' + args)\n  }\n\n  root.innerHTML = ''\n\n  var unique = parts[1].split(':')[1]\n    , prop = parts[1].split(':')[0]\n    , key = parts[2]\n\n  var runUpdates = this.batch.add(runDomUpdates)\n\n  lookups.register(key, update)\n\n  return {destroy: destroy}\n\n  function updateChildren(data) {\n    var itemData\n\n    for(var i = 0, l = children.length; i < l; ++i) {\n      itemData = Object.create(data)\n      itemData[prop] = items[i]\n      itemData['$index'] = i\n      children[i].lookups.update(itemData)\n    }\n  }\n\n  function destroy() {\n    for(var i = 0, l = children.length; i < l; ++i) {\n      runDestroy(children[i].hooks)\n    }\n  }\n\n  function update(newItems) {\n    if(!Array.isArray(newItems)) {\n      newItems = []\n    }\n\n    var newChildren = new Array(newItems.length)\n      , matched = {}\n      , index\n\n    domNodes = []\n\n    for(var i = 0, l = newItems.length; i < l; ++i) {\n      index = findIndex(items, newItems[i], unique)\n\n      if(index !== -1) {\n        newChildren[i] = children[index]\n        items[index] = children[index] = matched\n      } else {\n        newChildren[i] = makeChild()\n      }\n\n      domNodes = domNodes.concat(newChildren[i].nodes)\n    }\n\n    for(var i = 0, l = children.length; i < l; ++i) {\n      if(children[i] !== matched) {\n        runDestroy(children[i].hooks)\n      }\n    }\n\n    children = newChildren.slice()\n    items = newItems.slice()\n    runUpdates.call(altr)\n    updateChildren(lookups.state)\n  }\n\n  function findIndex(items, d, unique) {\n    if(!unique) {\n      return items.indexOf(d)\n    }\n\n    for(var i = 0, l = items.length; i < l; ++i) {\n      if(items[i][unique] === d[unique]) {\n        return i\n      }\n    }\n\n    return -1\n  }\n\n  function makeChild() {\n    var temp = altr.document.createElementNS(root.namespaceURI, 'div')\n\n    temp.innerHTML = template\n\n    return altr.initNodes(Array.prototype.slice.call(temp.childNodes))\n  }\n\n  function runDomUpdates() {\n    setChildren.call(this, root, domNodes)\n  }\n\n  function runDestroy(hooks) {\n    if(!hooks.destroy) {\n      return\n    }\n\n    var list = Array.isArray(hooks.destroy) ? hooks.destroy : [hooks.destroy]\n\n    for(var i = 0, l = list.length; i < l; ++i) {\n      list[i]()\n    }\n  }\n}\n","module.exports = ifTag\n\nfunction ifTag(el, getter, lookups) {\n  var placeholder = this.document.createComment('altr-if-placeholder')\n    , children = this.initNodes(el.childNodes)\n    , hidden = null\n    , altr = this\n\n  var hide = this.batch.add(function() {\n    var parent = el.parentNode\n\n    if(!hidden) {\n      altr.replace(el.parentNode, placeholder, el)\n      el._altrPlaceholder = placeholder\n      hidden = true\n    }\n  })\n\n  var show = this.batch.add(function() {\n    if(hidden) {\n      altr.replace(placeholder.parentNode, el, placeholder)\n      delete el._altrPlaceholder\n      hidden = false\n    }\n  })\n\n  lookups.register(getter, toggle, true)\n\n  return children.hooks\n\n  function toggle(val) {\n    if(!val) {\n      return hide()\n    }\n\n    show()\n    children.lookups.update(lookups.state)\n  }\n}\n","var EE = require('events').EventEmitter\n  , batch = require('batch-queue')\n  , dirtybit = require('dirtybit')\n\nvar templateString = require('./template-string')\n  , elementNode = require('./element-node')\n  , mergeHooks = require('./merge-hooks')\n  , textNode = require('./text-node')\n  , toString = require('./to-string')\n  , getEl = require('./get-element')\n  , replace = require('./replace')\n  , render = require('./render')\n  , insert = require('./insert')\n  , remove = require('./remove')\n  , raf = require('./raf')\n\n// dynamic require so it does not make it into the browserify bundle\nvar domModule = 'micro-dom'\n\naltr.filters = {}\naltr.includes = {}\naltr.directives = {}\naltr.render = render\naltr.addTag = addTag\naltr.include = include\naltr.addFilter = addFilter\naltr.addDirective = addDirective\n\nmodule.exports = altr\n\nfunction altr(root, data, sync, doc) {\n  if(!(this instanceof altr)) {\n    return new altr(root, data, sync, doc)\n  }\n\n  EE.call(this)\n  this.sync = !!sync\n  this.root = root\n  this.document = doc || global.document || require(domModule).document\n  this.filters = Object.create(altr.filters)\n  this.includes = Object.create(altr.includes)\n  this.directives = Object.create(altr.directives)\n  this.lookups = dirtybit(data, {filters: this.filters})\n  this.batch = batch((function() {\n    if(!this.sync) {\n      raf(this.runBatch.bind(this))\n    }\n  }).bind(this))\n\n  if(global.Buffer && root instanceof global.Buffer) {\n    root = root.toString()\n  }\n\n  if(typeof root === 'string') {\n    var temp = this.document.createElement('div')\n\n    temp.innerHTML = root\n    this.root = this.document.createDocumentFragment()\n\n    while(temp.firstChild) {\n      this.root.appendChild(temp.firstChild)\n    }\n  }\n\n  this.hooks = this.initNodes(this.rootNodes(), this.lookups)\n  this.runBatch()\n}\n\naltr.prototype = Object.create(EE.prototype)\naltr.prototype.constructor = altr\n\naltr.prototype.templateString = templateString\naltr.prototype.addDirective = addDirective\naltr.prototype.mergeHooks = mergeHooks\naltr.prototype.initNodes = initNodes\naltr.prototype.rootNodes = root_nodes\naltr.prototype.addFilter = addFilter\naltr.prototype.runBatch = runBatch\naltr.prototype.toString = toString\naltr.prototype.getElement = getEl\naltr.prototype.include = include\naltr.prototype.replace = replace\naltr.prototype.destroy = destroy\naltr.prototype.into = appendTo\naltr.prototype.update = update\naltr.prototype.insert = insert\naltr.prototype.remove = remove\naltr.prototype.tagList = []\naltr.prototype.tags = {}\n\nvar node_handlers = {}\n\nnode_handlers[1] = elementNode\nnode_handlers[3] = textNode\n\nfunction update(data, sync) {\n  this.state = data\n  this.lookups.update(data)\n  this.emit('update')\n\n  if(sync || this.sync) {\n    this.runBatch()\n  }\n}\n\nfunction initNodes(nodes, _lookups) {\n  var lookups = _lookups || dirtybit(null, {filters: this.filters})\n\n  var hooks = Array.prototype.slice.call(nodes)\n    .map(initNode.bind(this, lookups))\n    .filter(Boolean)\n    .reduce(this.mergeHooks.bind(this), {})\n\n  return {hooks: hooks, lookups: lookups, nodes: nodes}\n}\n\nfunction initNode(lookups, el) {\n  return node_handlers[el.nodeType] ?\n    node_handlers[el.nodeType].call(this, el, lookups) :\n    el.childNodes && el.childNodes.length ?\n    this.initNodes(lookups, el.childNodes) :\n    null\n}\n\nfunction root_nodes() {\n  return this.root.nodeType === this.document.DOCUMENT_FRAGMENT_NODE ?\n    [].slice.call(this.root.childNodes) :\n    [this.root]\n}\n\nfunction addFilter(name, filter) {\n  altr.filters[name] = filter\n}\n\nfunction addTag(attr, tag) {\n  altr.prototype.tags[attr] = tag\n  altr.prototype.tagList.push({\n      attr: attr\n    , constructor: tag\n  })\n}\n\nfunction appendTo(node) {\n  var root_nodes = this.rootNodes()\n\n  for(var i = 0, l = root_nodes.length; i < l; ++i) {\n    node.appendChild(getEl(root_nodes[i]))\n  }\n}\n\nfunction include(name, template) {\n  return this.includes[name] = template\n}\n\nfunction addFilter(name, fn) {\n  return this.filters[name] = fn\n}\n\nfunction addDirective(name, fn) {\n  return this.directives[name] = fn\n}\n\nfunction runBatch() {\n  this.batch.run() && this.emit('draw', this.state)\n}\n\nfunction destroy() {\n  var list = this.hooks.destroy\n\n  if(!this.hooks.destroy) {\n    return\n  }\n\n  if(Array.isArray(list)) {\n    list = [list]\n  }\n\n  for(var i = 0, l = list.length; i < l; ++i) {\n    list[i]()\n  }\n}\n","var TAG = /{{\\s*(.*?)\\s*}}/\n\nmodule.exports = templatString\n\nfunction templatString(template, change, lookups) {\n  if(!template.match(TAG)) {\n    return\n  }\n\n  var remaining = template\n    , parts = []\n    , hooks = []\n    , index\n    , next\n\n  while(remaining && (next = remaining.match(TAG))) {\n    if(index = remaining.indexOf(next[0])) {\n      parts.push(remaining.slice(0, index))\n    }\n\n    parts.push('')\n    remaining = remaining.slice(index + next[0].length)\n    lookups.register(next[1], setPart.bind(this, parts.length - 1))\n  }\n\n  if(remaining) {\n    parts.push(remaining)\n  }\n\n  function setPart(idx, val) {\n    parts[idx] = val\n    change(parts.join(''))\n  }\n}\n","var createDirectives = require('./directives')\n  , createAttr = require('./attributes')\n\nmodule.exports = createElementNode\n\nfunction createElementNode(el, lookups) {\n  var directives = []\n    , altr = this\n    , hooks = {}\n    , attr\n\n  var attrs = Array.prototype.slice.call(el.attributes)\n    , directives = []\n    , altr_tags = {}\n    , updates = []\n    , tags = {}\n\n  for(var i = 0, l = attrs.length; i < l; ++i) {\n    if(altr.tags[attrs[i].name]) {\n      altr_tags[attrs[i].name] = attrs[i].value\n    } else if(altr.directives[attrs[i].name]) {\n      directives.push(attrs[i])\n    } else if(!attrs[i].name.lastIndexOf('altr-attr-', 0)) {\n      updates.push(createAttr.altr.call(this, el, attrs[i], lookups))\n    } else if(!attrs[i].name.lastIndexOf('altr-prop-', 0)) {\n      updates.push(createAttr.prop.call(this, el, attrs[i], lookups))\n    } else {\n      updates.push(createAttr.raw.call(this, el, attrs[i], lookups))\n    }\n  }\n\n  hooks.updates\n\n  if(directives.length) {\n    hooks = altr.mergeHooks(\n        hooks\n      , createDirectives.call(altr, el, directives, lookups)\n    )\n  }\n\n  for(var i = 0, l = altr.tagList.length; i < l; ++i) {\n    if(attr = altr_tags[altr.tagList[i].attr]) {\n      return altr.mergeHooks(\n          hooks\n        , altr.tagList[i].constructor.call(altr, el, attr, lookups)\n      )\n    }\n  }\n\n  return altr.mergeHooks(hooks, altr.initNodes(el.childNodes, lookups))\n}\n","module.exports = merge\n\nvar types = ['update', 'insert', 'remove', 'destroy']\n\nfunction merge(_lhs, _rhs) {\n  var out = {}\n    , type\n\n  var lhs = _lhs || {}\n    , rhs = _rhs || {}\n\n  for(var i = 0, l = types.length; i < l; ++i) {\n    type = arrayify(lhs[types[i]]).concat(arrayify(rhs[types[i]]))\n\n    if(type.length) {\n      out[types[i]] = type\n    }\n  }\n\n  return Object.keys(out).length ? out : null\n}\n\nfunction arrayify(obj) {\n  return obj ? Array.isArray(obj) ? obj.filter(Boolean) : [obj] : []\n}\n","module.exports = initTextNode\n\nfunction initTextNode(el, lookups) {\n  this.templateString(\n      el.textContent\n    , this.batch.add(update)\n    , lookups\n  )\n\n  function update(val) {\n    el.textContent = val\n  }\n}\n","module.exports = toString\n\nfunction toString() {\n  return this.rootNodes().map(function(node) {\n    switch(node.nodeType) {\n      case this.document.DOCUMENT_FRAGMENT_NODE:\n      case this.document.COMMENT_NODE: return clone.call(this, node)\n      case this.document.TEXT_NODE: return node.textContent\n      default: return node.outerHTML\n    }\n  }, this).join('')\n\n  function clone(node) {\n    var temp = this.document.createElement('div')\n\n    temp.appendChild(node.cloneNode(true))\n\n    return temp.innerHTML\n  }\n}\n","module.exports = get\n\nfunction get(_el) {\n  var el = _el\n\n  while(el && el._altrPlaceholder) {\n    el = el._altrPlaceholder\n\n    if(el === _el) {\n      throw new Error('placeholder circular refference')\n    }\n  }\n\n  return el\n}\n","module.exports = replace\n\nfunction replace(parent, el, old) {\n  parent.replaceChild(el, old)\n  this.emit('replace', el, old, parent)\n  this.emit('insert', el, parent)\n  this.emit('remove', old, parent)\n}\n","module.exports = render\n\nfunction render(template, state, el) {\n  if(this.includes[template]) {\n    template = this.includes[template]\n  }\n\n  var instance = this(template)\n\n  instance.update(state || {}, true)\n\n  if(el) {\n    instance.into(el)\n  }\n\n  return instance\n}\n","module.exports = insert\n\nfunction insert(parent, el, before) {\n  var inserted = el.parentNode !== parent\n\n  before = before || null\n\n  if(inserted || el.nextSibling !== before) {\n    parent.insertBefore(el, before)\n  }\n\n  if(inserted) {\n    this.emit('insert', el, parent)\n  }\n}\n","module.exports = remove\n\nfunction remove(parent, el) {\n  parent.removeChild(el)\n  this.emit('remove', el, parent)\n}\n","module.exports = requestAnimationFrame\n\nfunction requestAnimationFrame(callback) {\n  var raf = global.requestAnimationFrame ||\n    global.webkitRequestAnimationFrame ||\n    global.mozRequestAnimationFrame ||\n    timeout\n\n  return raf(callback)\n\n  function timeout(callback) {\n    return setTimeout(callback, 1000 / 60)\n  }\n}\n","var get = require('./get-element')\n\nmodule.exports = setChildren\n\nfunction setChildren(root, nodes) {\n  var prev = null\n    , el\n\n  for(var i = nodes.length - 1; i >= 0; --i) {\n    el = get(nodes[i])\n    this.insert(root, el, prev)\n    prev = el\n  }\n\n  while((el = root.firstChild) !== prev) {\n    this.remove(root, el)\n  }\n}\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      } else {\n        throw TypeError('Uncaught, unspecified \"error\" event.');\n      }\n      return false;\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        len = arguments.length;\n        args = new Array(len - 1);\n        for (i = 1; i < len; i++)\n          args[i - 1] = arguments[i];\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    len = arguments.length;\n    args = new Array(len - 1);\n    for (i = 1; i < len; i++)\n      args[i - 1] = arguments[i];\n\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    var m;\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  var ret;\n  if (!emitter._events || !emitter._events[type])\n    ret = 0;\n  else if (isFunction(emitter._events[type]))\n    ret = 1;\n  else\n    ret = emitter._events[type].length;\n  return ret;\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n","module.exports = directives\n\nfunction directives(el, attrs, lookups) {\n  var self = this\n    , hooks = []\n\n  for(var i = 0, l = attrs.length; i < l; ++i) {\n    hooks.push(create_directive(\n        el\n      , self.directives[attrs[i].name]\n      , attrs[i].value\n    ))\n  }\n\n  if(hooks.length) {\n    return hooks.reduce(self.mergeHooks, {})\n  }\n\n  function create_directive(el, create, getter) {\n    var hooks = create(el)\n\n    if(!hooks) {\n      return\n    }\n\n    if(hooks.update) {\n      lookups.register(getter, hooks.update)\n      delete hooks.update\n    }\n\n    return hooks\n  }\n}\n","module.exports.raw = rawAttribute\nmodule.exports.altr = altrAttribute\nmodule.exports.prop = altrProperty\n\nfunction rawAttribute(el, attr, lookups) {\n  return this.templateString(\n      attr.value\n    , this.batch.add(el.setAttribute.bind(el, attr.name))\n    , lookups\n  )\n}\n\nfunction altrAttribute(el, attr, lookups) {\n  var name = attr.name.slice('altr-attr-'.length)\n\n  lookups.register(attr.value, this.batch.add(update))\n  el.removeAttribute(attr.name)\n\n  function update(val) {\n    if(!val && val !== '' && val !== 0) {\n      return el.removeAttribute(name)\n    }\n\n    if(val === true) {\n      return el.setAttribute(name, '')\n    }\n\n    el.setAttribute(name, val)\n  }\n}\n\nfunction altrProperty(el, attr, lookups) {\n  var name = attr.name.slice('altr-prop-'.length)\n\n  el.removeAttribute(attr.name)\n  lookups.register(attr.value, this.batch.add(update))\n\n  function update(val) {\n    el[name] = val\n  }\n}\n","module.exports = Batch\n\nfunction Batch(ready, all) {\n  if(!(this instanceof Batch)) {\n    return new Batch(ready, all)\n  }\n\n  this.jobs = []\n  this.all = all\n  this.ready = ready\n  this.queud = false\n  this.run = this.run.bind(this)\n}\n\nBatch.prototype.queue = queue\nBatch.prototype.add = add\nBatch.prototype.run = run\n\nfunction add(fn) {\n  var queued = false\n    , batch = this\n    , self\n    , args\n\n  return queue\n\n  function queue() {\n    args = [].slice.call(arguments)\n    self = this\n\n    if(queued) {\n      return batch.all && batch.ready()\n    }\n\n    queued = true\n    batch.queue(run)\n  }\n\n  function run() {\n    queued = false\n    fn.apply(self, args)\n  }\n}\n\nfunction queue(fn) {\n  this.jobs.push(fn)\n\n  if(this.all || !this.queued) {\n    this.queued = true\n    this.ready(this)\n  }\n}\n\nfunction run() {\n  var jobs = this.jobs\n\n  this.jobs = []\n  this.queued = false\n\n  for(var i = 0, l = jobs.length; i < l; ++i) {\n    jobs[i]()\n  }\n\n  return !!this.jobs.length\n}\n","var operators = require('./types/operators')\n  , brackets = require('./types/brackets')\n  , dot_path = require('./types/dot-path')\n  , filters = require('./types/filters')\n  , partial = require('./types/partial')\n  , EE = require('events').EventEmitter\n  , parens = require('./types/parens')\n  , values = require('./types/values')\n  , split = require('./split')\n  , list = require('./list')\n\nmodule.exports = DirtyBit\n\nfunction DirtyBit(state, _options) {\n  if(!(this instanceof DirtyBit)) {\n    return new DirtyBit(state, _options)\n  }\n\n  var options = _options || {}\n\n  EE.call(this)\n  this.state = state || {}\n  this.events = new EE\n  this.deps = Object.create(null)\n  this.values = Object.create(null)\n  this.lookups = Object.create(null)\n  this.filters = Object.create(options.filters || null)\n  this.always = []\n  this.getters = []\n  this.updating = false\n  this.updates = {}\n  this.setMaxListeners(0)\n  this.events.setMaxListeners(0)\n  this.rootKey = options.rootKey\n  this.lookups['this'] = Infinity\n  this.lookups[this.rootKey] = Infinity\n  this.update(this.state)\n}\n\nDirtyBit.prototype = Object.create(EE.prototype)\nDirtyBit.prototype.updateValue = updateValue\nDirtyBit.prototype.deregister = deregister\nDirtyBit.prototype.constructor = DirtyBit\nDirtyBit.prototype.addFilter = addFilter\nDirtyBit.prototype.register = register\nDirtyBit.prototype.registerList = list\nDirtyBit.prototype.update = update\nDirtyBit.prototype.on = cleaned_on\nDirtyBit.prototype.watch = watch\nDirtyBit.prototype.clean = clean\nDirtyBit.prototype.split = split\nDirtyBit.prototype.hash = hash\nDirtyBit.prototype.types = []\n\nDirtyBit.prototype.types.push(values)\nDirtyBit.prototype.types.push(filters)\nDirtyBit.prototype.types.push(partial)\nDirtyBit.prototype.types.push(parens)\nDirtyBit.prototype.types.push(operators)\nDirtyBit.prototype.types.push(brackets)\nDirtyBit.prototype.types.push(dot_path)\n\nfunction register(_lookup, callback, all, dep_of, _first) {\n  var first = _first || typeof first === 'undefined'\n    , lookup = this.clean(_lookup)\n\n  if(dep_of) {\n    this.events.on(lookup, callback)\n    this.deps[dep_of] = this.deps[dep_of] || {}\n    this.deps[dep_of][lookup] = callback\n  } else if(all) {\n    this.always.push({lookup: lookup, callback: callback})\n  } else {\n    this.on(lookup, callback)\n  }\n\n  if((this.lookups[lookup] = (this.lookups[lookup] || 0) + 1) !== 1) {\n    if(first) {\n      callback.apply(\n          this\n        , this.values[lookup] ? this.values[lookup].slice(1) : undefined\n      )\n    }\n\n    return\n  }\n\n  if(!this.updating) {\n    this.updating = true\n    this.watch(lookup)\n    this.updating = false\n    first && callback.apply(\n        this\n      , this.values[lookup] ? this.values[lookup].slice(1) : undefined\n    )\n    this.updates = {}\n  } else {\n    this.watch(lookup)\n  }\n\n}\n\nfunction deregister(_lookup, callback) {\n  var lookup = this.clean(_lookup)\n    , deps = this.deps[lookup]\n    , names\n\n  this.removeListener(lookup, callback)\n  this.events.removeListener(lookup, callback)\n  --this.lookups[lookup]\n\n  if(this.lookups[lookup] > 0 || !deps) {\n    return\n  }\n\n  this.always = this.always.filter(function(handler) {\n    return !(handler.callback === callback && handler.lookup === lookup)\n  })\n\n  if(!this._events[lookup] && !this.events._events[lookup]) {\n    names = Object.keys(deps)\n    delete this.deps[lookup]\n    delete this.values[lookup]\n    delete this.lookups[lookup]\n\n    for(var i = 0, l = names.length; i < l; ++i) {\n      this.deregister(names[i], deps[names[i]])\n    }\n  }\n}\n\nfunction watch(_lookup) {\n  var lookups = this.split(this.clean(_lookup), ',', true)\n\n  if(lookups.length > 1) {\n    return this.registerList(lookups,lookups.join(','))\n  }\n\n  for(var i = 0, l = this.types.length; i < l; ++i) {\n    if(this.types[i].call(this, lookups[0])) {\n      break\n    }\n  }\n\n  if(i === l) {\n    throw new Error('invalid lookup: ' + lookups[0])\n  }\n}\n\nfunction updateValue(lookup) {\n  var args = Array.prototype.slice.call(arguments)\n\n  for(var i = 0, l = args.length; i < l; ++i) {\n    if(!this.values[lookup]) {\n      break\n    }\n\n    if(this.values[lookup][i] === args[i] && typeof args[i] !== 'object') {\n      break\n    }\n  }\n\n  if(i === l) {\n    return\n  }\n\n  this.values[lookup] = args\n  this.events.emit.apply(this.events, args)\n\n  if(this.updating) {\n    return this.updates[lookup] = args\n  }\n\n  this.emit.apply(this, args)\n}\n\nfunction update(val) {\n  this.updating = true\n  this.state = val\n  this.state\n\n  this.updateValue('this', val)\n  this.rootKey && this.updateValue(this.rootKey, val)\n\n  for(var i = 0, l = this.getters.length; i < l; ++i) {\n    this.getters[i](val)\n  }\n\n  this.updating = false\n\n  var updates = Object.keys(this.updates)\n\n  for(var i = 0, l = updates.length; i < l; ++i) {\n    this.emit.apply(this, this.updates[updates[i]])\n  }\n\n  for(var i = 0, l = this.always.length; i < l; ++i) {\n    this.always[i].callback.apply(\n        this\n      , this.values[this.always[i].lookup].slice(1)\n    )\n  }\n\n  this.updates = {}\n}\n\nfunction addFilter(name, filter) {\n  this.filters[name] = filter\n}\n\nfunction clean(lookup) {\n  return this.split(lookup, ',', true).map(trim).join(',')\n}\n\nfunction trim(str) {\n  return str.replace(/^\\s+|\\s+$/g, '')\n}\n\nfunction cleaned_on(lookup, callback) {\n  EE.prototype.on.call(this, this.clean(lookup), callback)\n}\n\nfunction hash(str) {\n  var hash = 0\n\n  for(var i = 0, len = str.length; i < len; ++i) {\n    hash = ((hash << 5) - hash) + str.charCodeAt(i)\n    hash |= 0\n  }\n\n  return hash.toString().replace('-', '#')\n}\n","var ternary_regexp = /^\\s*(.+?)\\s*\\?(.*)\\s*$/\n\nmodule.exports = operator\n\nvar updaters = {}\n  , types = []\n\n// push in inverse order of operations\ntypes.push({\n    test: ternary_regexp\n  , create: create_ternary\n})\n\ntypes.push(binary(['|\\\\|']))\ntypes.push(binary(['&&']))\ntypes.push(binary(['|']))\ntypes.push(binary(['^']))\ntypes.push(binary(['&']))\ntypes.push(binary(['===', '!==', '==', '!=']))\ntypes.push(binary(['>=', '<=', '>', '<', ' in ', ' instanceof ']))\n// types.push(binary(['<<', '>>', '>>>'])) //conflics with < and >\ntypes.push(binary(['+', '-']))\ntypes.push(binary(['*', '/', '%']))\ntypes.push(unary(['!', '+', '-', '~']))\n\nupdaters['in'] = update_in\nupdaters['instanceof'] = update_instanceof\n\nfunction operator(lookup) {\n  var parts\n\n  for(var i = 0, l = types.length; i < l; ++i) {\n    if(parts = lookup.match(types[i].test)) {\n      types[i].create.call(this, parts, lookup)\n\n      return true\n    }\n  }\n}\n\nfunction create_ternary(parts, lookup) {\n  var self = this\n    , right\n    , left\n    , ok\n\n  var rest = self.split(parts[2], ':')\n\n  if(rest.length !== 2) {\n    throw new Error('Unmatched ternary in: ' + lookup)\n  }\n\n  self.register(parts[1], update_ok, false, lookup)\n  self.register(rest[0], update_left, false, lookup)\n  self.register(rest[1], update_right, false, lookup)\n\n  function update_ok(val) {\n    ok = val\n    update()\n  }\n\n  function update_left(val) {\n    left = val\n    update()\n  }\n\n  function update_right(val) {\n    right = val\n    update()\n  }\n\n  function update() {\n    self.updateValue(lookup, ok ? left : right)\n  }\n}\n\nfunction binary(list) {\n  return {\n      test: new RegExp('^(.+?)(\\\\' + list.join('|\\\\') + ')(.+)$')\n    , create: create_binary\n  }\n}\n\nfunction create_binary(parts, lookup) {\n  var update = updaters[this.clean(parts[2])]\n    , self = this\n    , right\n    , left\n\n  if(!update) {\n    update = Function('lhs, rhs', 'return lhs ' + parts[2] + ' rhs')\n  }\n\n  self.register(parts[1], update_left, false, lookup)\n  self.register(parts[3], update_right, false, lookup)\n\n  function update_left(val) {\n    self.updateValue(lookup, update(left = val, right))\n  }\n\n  function update_right(val) {\n    self.updateValue(lookup, update(left, right = val))\n  }\n}\n\nfunction unary(list) {\n  var regex = new RegExp('^(\\\\' + list.join('|\\\\') + ')(.+)$')\n\n  return {test: regex, create: create_unary}\n}\n\nfunction create_unary(parts, lookup) {\n  var update = Function('val', 'return ' + parts[1] + 'val')\n    , self = this\n\n  self.register(parts[2], function(val) {\n    self.updateValue(lookup, update(val))\n  }, false, lookup)\n}\n\nfunction update_in(left, right) {\n  return typeof right !== 'undefined' && left in right\n}\n\nfunction update_instanceof(left, right) {\n  return typeof right === 'function' && left instanceof right\n}\n","var has_bracket = /^.+\\[.+\\]$/\n\nmodule.exports = dot_path\n\nfunction dot_path(lookup) {\n  if(!has_bracket.test(lookup)) {\n    return\n  }\n\n  var pairs = this.split.pairs.map(function(pair) {\n    return [pair[1], pair[0], pair[2]]\n  })\n\n  var parts = this.split(reverse(lookup.slice(0, -1)), '[', false, pairs)\n    .map(reverse)\n\n  var self = this\n    , inner\n    , root\n\n  this.register(parts[0], update_inner, false, lookup)\n  this.register(parts[1], update_root, false, lookup)\n\n  function update_inner(val) {\n    inner = val\n    update()\n  }\n\n  function update_root(val) {\n    root = val\n    update()\n  }\n\n  return true\n\n  function update() {\n    if(root === null || root === undefined) {\n      return self.updateValue(lookup, undefined)\n    }\n\n    self.updateValue(lookup, root[inner])\n  }\n}\n\nfunction reverse(str) {\n  return str.split('').reverse().join('')\n}\n","var valid_path = /^(.*)\\.([^.\\s]+)$/\n\nmodule.exports = dot_path\n\nfunction dot_path(lookup) {\n  var parts = lookup.match(valid_path)\n    , self = this\n\n  if(parts) {\n    self.register(parts[1], update, false, lookup)\n\n    return true\n  }\n\n  update(self.state)\n\n  return self.getters.push(update)\n\n  function update(obj) {\n    if(obj === null || obj === undefined) {\n      return self.updateValue(lookup, undefined)\n    }\n\n    self.updateValue(lookup, obj[parts ? parts[2] : lookup])\n  }\n}\n","var filter_regexp = /^([^\\s(]+)\\((.*)\\)$/\n\nmodule.exports = create_filter\n\nfunction create_filter(lookup) {\n  var parts = lookup.match(filter_regexp)\n    , self = this\n\n  if(!parts) {\n    return\n  }\n\n  var filter = self.filters[parts[1]]\n\n  if(!filter) {\n    throw new Error('could not find filter: ' + lookup)\n  }\n\n  filter = filter.call(self, update)\n  self.register(parts[2], notify, false, lookup)\n\n  return true\n\n  function notify() {\n    filter.apply(self, arguments)\n  }\n\n  function update(val) {\n    self.updateValue(lookup, val)\n  }\n}\n","var regexp = /^\\{\\{.+\\}\\}$/\n\nmodule.exports = partial\n\nfunction partial(lookup) {\n  var value = this.values[lookup]\n\n  if(regexp.test(lookup)) {\n    if(this.lookups[lookup] === 1) {\n      this.values[lookup] = [lookup]\n      this.updateValue.apply(this, value)\n    }\n\n    return true\n  }\n}\n","var parens_regexp = /(^|[^0-9a-zA-Z_$])\\((.*)$/\n\nmodule.exports = create_parens\n\nfunction create_parens(lookup) {\n  var parts = lookup.match(parens_regexp)\n\n  if(!parts) {\n    return\n  }\n\n  var body = parts[2]\n    , self = this\n    , count = 1\n    , inner\n    , outer\n\n  for(var i = 0, l = body.length; i < l; ++i) {\n    if(body[i] === ')') {\n      --count\n    } else if(body[i] === '(') {\n      ++count\n    }\n\n    if(!count) {\n      break\n    }\n  }\n\n  if(!i || i === l) {\n    throw new Error('Unmatched parens: ' + lookup)\n  }\n\n  var inner = body.slice(0, i)\n\n  var key = '{{paren_' + self.hash(inner) + '}}'\n\n  var patched = lookup.slice(0\n    , lookup.lastIndexOf([parts[2]]) - 1\n  ) + key + body.slice(i + 1)\n\n  self.register(inner, function(val) {\n    self.updateValue(key, val)\n  }, false, lookup)\n\n  self.register(patched, update, false, lookup)\n\n  return true\n\n  function update(val) {\n    self.updateValue(lookup, val)\n  }\n}\n","var string_regexp = /^(?:'((?:[^'\\\\]|(?:\\\\.))*)'|\"((?:[^\"\\\\]|(?:\\\\.))*)\")$/\n  , number_regexp = /^(\\d*(?:\\.\\d+)?)$/\n\nmodule.exports = create_value\n\nvar vals = {\n    'true': true\n  , 'false': false\n  , 'null': null\n  , 'undefined': undefined\n}\n\nfunction create_value(lookup) {\n  var parts\n\n  if(vals.hasOwnProperty(lookup)) {\n    return this.updateValue(lookup, vals[lookup]) || true\n  }\n\n  if(parts = lookup.match(number_regexp)) {\n    return this.updateValue(lookup, +parts[1]) || true\n  }\n\n  if(parts = lookup.match(string_regexp)) {\n    return this.updateValue(lookup, parts[1] || parts[2] || '') || true\n  }\n}\n","var default_pairs = [\n    ['(', ')']\n  , ['[', ']']\n  , ['?', ':']\n  , ['\"', '\"', true]\n  , [\"'\", \"'\", true]\n]\n\nmodule.exports = split\nmodule.exports.pairs = default_pairs\n\nfunction split(parts, key, all, _pairs) {\n  var pairs = _pairs || default_pairs\n    , inString = false\n    , layers = []\n\n  for(var i = 0, l = parts.length; i < l; ++i) {\n    if(!layers.length) {\n      for(var j = 0, l2 = key.length; j < l2; ++j) {\n        if(parts[i + j] !== key[j]) {\n          break\n        }\n      }\n\n      if(j === key.length) {\n        break\n      }\n    }\n\n    if(layers.length && layers[layers.length - 1] === parts[i]) {\n      inString = false\n      layers.pop()\n\n      continue\n    }\n\n    if(inString) {\n      continue\n    }\n\n    for(var j = 0, l2 = pairs.length; j < l2; ++j) {\n      if(parts[i] === pairs[j][0]) {\n        if(pairs[j][2]) {\n          inString = true\n        }\n\n        layers.push(pairs[j][1])\n\n        break\n      }\n    }\n  }\n\n  if(layers.length) {\n    throw new Error(\n      'Unmatched pair in ' + parts + '. expecting: ' + layers.pop()\n    )\n  }\n\n  if(i === parts.length) {\n    return [parts]\n  }\n\n  var right = parts.slice(i + key.length)\n    , left = parts.slice(0, i)\n\n  if(!all) {\n    return [left, right]\n  }\n\n  return [left].concat(split(right, key, all, pairs))\n}\n","module.exports = list\n\nfunction list(_lookups, key) {\n  var lookups = _lookups.map(this.clean.bind(this))\n    , values = new Array(_lookups.length)\n\n  for(var i = 0, l = lookups.length; i < l; ++i) {\n    this.register(lookups[i], update.bind(this, i), false, key)\n  }\n\n  function update(i, val) {\n    values[i] = val\n    this.updateValue.apply(this, [key].concat(values))\n  }\n}\n"]}