{"version":3,"file":"bundle.js","sources":["/Users/mhayes/code/altr/node_modules/browserify/node_modules/browser-pack/_prelude.js","/Users/mhayes/code/altr/lib/browser.js","/Users/mhayes/code/altr/lib/index.js","/Users/mhayes/code/altr/lib/tags/placeholder.js","/Users/mhayes/code/altr/lib/tags/children.js","/Users/mhayes/code/altr/lib/tags/include.js","/Users/mhayes/code/altr/lib/tags/text.js","/Users/mhayes/code/altr/lib/tags/html.js","/Users/mhayes/code/altr/lib/tags/with.js","/Users/mhayes/code/altr/lib/tags/for.js","/Users/mhayes/code/altr/lib/tags/raw.js","/Users/mhayes/code/altr/lib/tags/if.js","/Users/mhayes/code/altr/lib/altr.js","/Users/mhayes/code/altr/lib/template-string.js","/Users/mhayes/code/altr/lib/element-node.js","/Users/mhayes/code/altr/lib/merge-hooks.js","/Users/mhayes/code/altr/lib/altr-extend.js","/Users/mhayes/code/altr/lib/text-node.js","/Users/mhayes/code/altr/lib/to-string.js","/Users/mhayes/code/altr/lib/run-hooks.js","/Users/mhayes/code/altr/lib/get-element.js","/Users/mhayes/code/altr/lib/destroy.js","/Users/mhayes/code/altr/lib/render.js","/Users/mhayes/code/altr/lib/remove.js","/Users/mhayes/code/altr/lib/raf.js","/Users/mhayes/code/altr/lib/set-children.js","/Users/mhayes/code/altr/node_modules/browserify/node_modules/events/events.js","/Users/mhayes/code/altr/lib/decorators.js","/Users/mhayes/code/altr/lib/attributes.js","/Users/mhayes/code/altr/node_modules/batch-queue/index.js","/Users/mhayes/code/altr/node_modules/dirtybit/lib/index.js","/Users/mhayes/code/altr/node_modules/extend/index.js","/Users/mhayes/code/altr/node_modules/dirtybit/lib/expression.js","/Users/mhayes/code/altr/node_modules/dirtybit/lib/split.js","/Users/mhayes/code/altr/node_modules/dirtybit/lib/watch.js","/Users/mhayes/code/altr/node_modules/dirtybit/lib/hash.js","/Users/mhayes/code/altr/node_modules/dirtybit/lib/remove.js","/Users/mhayes/code/altr/node_modules/dirtybit/lib/parse.js","/Users/mhayes/code/altr/node_modules/dirtybit/lib/types/index.js","/Users/mhayes/code/altr/node_modules/dirtybit/lib/types/brackets.js","/Users/mhayes/code/altr/node_modules/dirtybit/lib/types/dot-path.js","/Users/mhayes/code/altr/node_modules/dirtybit/lib/types/filters.js","/Users/mhayes/code/altr/node_modules/dirtybit/lib/types/partial.js","/Users/mhayes/code/altr/node_modules/dirtybit/lib/types/ternary.js","/Users/mhayes/code/altr/node_modules/dirtybit/lib/types/parens.js","/Users/mhayes/code/altr/node_modules/dirtybit/lib/types/values.js","/Users/mhayes/code/altr/node_modules/dirtybit/lib/types/binary.js","/Users/mhayes/code/altr/node_modules/dirtybit/lib/types/unary.js","/Users/mhayes/code/altr/node_modules/dirtybit/lib/types/list.js"],"names":["module","exports","global","altr","require","placeholder","childrenTag","includeTag","textTag","htmlTag","withTag","forTag","rawTag","ifTag","addTag","original","getter","lookups","update","val","nodeName","current","parentNode","replaceChild","_altrPlaceholder","this","batch","add","on","children","el","nodes","Array","isArray","filter","is_node","i","l","length","setChildren","call","innerHTML","bind","nodeType","include","name","insert","includes","initNodes","childNodes","state","remove","done","removing","destroy","removeListener","text","textContent","html","accessor","getAttribute","forEach","getElementsByTagName","run","script","fixed","document","createElement","parent","attrs","attributes","setAttribute","value","insertBefore","removeChild","_val","Object","create","parts","split","hooks","forHandler","root","args","updateChildren","data","itemData","prop","items","newItems","index","newChildren","removed","matched","added","domNodes","findIndex","unique","push","makeChild","concat","slice","flatten","runUpdates","d","indexOf","template","cloneNode","runDomUpdates","runHooks","match","forRegexp","console","error","key","mergeHooks","list","reduce","all","part","decorators","toggle","lastVal","hidden","createComment","first","show","origin","options","filters","extend","sync","tagRegExp","makeTagRegExp","delimiters","doc","domModule","dirtybit","raf","runBatch","Buffer","toString","temp","createDocumentFragment","firstChild","appendChild","rootNodes","_nodes","_lookups","join","node","initNode","prototype","Boolean","node_handlers","DOCUMENT_FRAGMENT_NODE","addFilter","attr","tag","tags","tagList","constructor","appendTo","getEl","fn","addDecorator","emit","_delimiters","RegExp","EE","EventEmitter","templateString","elementNode","altrExtend","textNode","render","getElement","into","templatString","change","setPart","idx","next","remaining","createElementNode","altr_tags","lastIndexOf","createAttr","raw","createDecorators","merge","each","type","ready","base","extension","baseOptions","initTextNode","clone","map","COMMENT_NODE","TEXT_NODE","outerHTML","get","_el","Error","instance","requestAnimationFrame","callback","timeout","setTimeout","webkitRequestAnimationFrame","mozRequestAnimationFrame","prev","_events","_maxListeners","undefined","isFunction","arg","isNumber","isObject","isUndefined","defaultMaxListeners","setMaxListeners","n","isNaN","TypeError","er","handler","len","listeners","arguments","apply","addListener","listener","m","newListener","warned","trace","once","g","fired","position","splice","removeAllListeners","ret","listenerCount","emitter","createDecorator","expression","decorator","rawAttribute","altrAttribute","removeAttribute","altrProperty","Batch","jobs","queud","queue","self","queued","DirtyBit","partials","rootKey","rootExpression","Expression","expressions","handlers","handlerList","removable","updating","report","lookup","changed","j","l2","trim","str","replace","_lookup","watch","types","parse","hash","parsed","hasOwn","hasOwnProperty","isPlainObject","obj","setInterval","has_own_constructor","has_is_property_of_method","src","copy","copyIsArray","target","deep","deps","dependents","_pairs","pairs","default_pairs","inString","layers","pop","right","left","seen","keys","createHandler","getDep","createExpression","echo","proxy","charCodeAt","removeExpression","dep","order","brackets","dot_path","partial","ternary","parens","values","binary","unary","has_bracket","test","pair","reverse","inner","valid_path","filter_regexp","regexp","ternary_regexp","rest","ok","parens_regexp","body","patched","vals","number_regexp","string_regexp","true","false","null","tests","op","ops","createOp","Function","updateIn","updateInstanceof","create_op","is_list"],"mappings":"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","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error(\"Cannot find module '\"+o+\"'\")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","module.exports = global.altr = require('./index')\n","var placeholder = require('./tags/placeholder')\n  , childrenTag = require('./tags/children')\n  , includeTag = require('./tags/include')\n  , textTag = require('./tags/text')\n  , htmlTag = require('./tags/html')\n  , withTag = require('./tags/with')\n  , forTag = require('./tags/for')\n  , rawTag = require('./tags/raw')\n  , ifTag = require('./tags/if')\n  , altr = require('./altr')\n\nmodule.exports = altr\n\naltr.addTag('altr-children', childrenTag)\naltr.addTag('altr-replace', placeholder)\naltr.addTag('altr-include', includeTag)\naltr.addTag('altr-text', textTag)\naltr.addTag('altr-html', htmlTag)\naltr.addTag('altr-with', withTag)\naltr.addTag('altr-for', forTag)\naltr.addTag('altr-raw', rawTag)\naltr.addTag('altr-if', ifTag)\n","module.exports = placeholder\n\nfunction placeholder(original, getter, lookups) {\n  var current = original\n    , altr = this\n\n  this.batch.add(lookups.on(getter, update))\n\n  function update(val) {\n    if(!val || !val.nodeName || val === current) {\n      return\n    }\n\n    current.parentNode.replaceChild(val, current)\n    original._altrPlaceholder = val\n    current = val\n  }\n}\n","var setChildren = require('../set-children')\n\nmodule.exports = children\n\nfunction children(el, getter, lookups) {\n  var current = []\n\n  el.innerHTML = ''\n  this.batch.add(lookups.on(getter, update.bind(this)))\n\n  function update(val) {\n    var nodes = (Array.isArray(val) ? val : [val]).filter(is_node)\n\n    for(var i = 0, l = nodes.length; i < l; ++i) {\n      if(nodes[i] !== current[i]) {\n        break\n      }\n    }\n\n    if(i === nodes.length === current.length) {\n      return\n    }\n\n    current = nodes\n    setChildren.call(this, el, current)\n  }\n}\n\nfunction is_node(el) {\n  return el && el.nodeType\n}\n","module.exports = include\n\nfunction include(el, name, lookups) {\n  var removing = false\n  var children = null\n  var altr = this\n\n  lookups.on('this', update)\n\n  return {insert: insert, remove: remove, destroy: destroy}\n\n  function insert() {\n    if(children) {\n      return\n    }\n\n    el.innerHTML = altr.includes[name]\n    children = altr.initNodes(el.childNodes, null, lookups.state)\n  }\n\n  function remove(el, done) {\n    if(!children || removing) {\n      return\n    }\n\n    children = null\n    removing = true\n    altr.destroy(children, el, function() {\n      removing = false\n\n      if(!children) {\n        el.innerHTML = ''\n      }\n\n      done()\n    })\n\n  }\n\n  function update(state) {\n    children && children.lookups.update(state)\n  }\n\n  function destroy() {\n    lookups.removeListener('this', update)\n  }\n}\n","module.exports = text\n\nfunction text(el, getter, lookups) {\n  this.batch.add(lookups.on(getter, update))\n\n  function update(val) {\n    el.textContent = typeof val === 'undefined' ? '' : val\n  }\n}\n","module.exports = html\n\nfunction html(el, accessor, lookups) {\n  this.batch.add(lookups.on(accessor, update))\n\n  function update(val) {\n    el.innerHTML = typeof val === 'undefined' ? '' : val\n\n    if(el.getAttribute('altr-run-scripts')) {\n      [].forEach.call(el.getElementsByTagName('script'), run)\n    }\n  }\n}\n\nfunction run(script) {\n  var fixed = document.createElement('script')\n    , parent = script.parentNode\n    , attrs = script.attributes\n    , src\n\n  for(var i = 0, l = attrs.length; i < l; ++i) {\n    fixed.setAttribute(attrs[i].name, attrs[i].value)\n  }\n\n  fixed.textContent = script.textContent\n  parent.insertBefore(fixed, script)\n  parent.removeChild(script)\n}\n","module.exports = withTag\n\nfunction withTag(el, getter, lookups) {\n  var children = this.initNodes(el.childNodes)\n    , parts = getter.split(' as ')\n\n  lookups.on(parts[0], update)\n\n  return children.hooks\n\n  function update(_val) {\n    var val = Object.create(lookups.state)\n\n    val[parts[1]] = _val\n    children.lookups.update(val)\n  }\n}\n","var setChildren = require('../set-children')\nvar forRegexp = /^(.*?)\\s+in\\s+(.*$)/\n\nmodule.exports = forHandler\n\nfunction forHandler(root, args, lookups) {\n  var template = root.cloneNode(true)\n  var parts = args.match(forRegexp)\n  var domNodes = []\n  var children = []\n  var altr = this\n  var items = []\n\n  if(!parts) {\n    return console.error('invalid `for` tag: ' + args)\n  }\n\n  var runUpdates = altr.batch.add(runDomUpdates)\n\n  root.innerHTML = ''\n\n  var unique = parts[1].split(':')[1]\n  var prop = parts[1].split(':')[0]\n  var key = parts[2]\n\n\n  lookups.on(key, update)\n\n  return altr.mergeHooks(function() {\n    return flatten(children)\n  })\n\n  function updateChildren(data) {\n    var itemData\n\n    for(var i = 0, l = children.length; i < l; ++i) {\n      itemData = Object.create(data)\n      itemData[prop] = items[i]\n      itemData['$index'] = i\n      children[i].lookups.update(itemData)\n    }\n  }\n\n  function update(newItems) {\n    if(!Array.isArray(newItems)) {\n      newItems = []\n    }\n\n    var newChildren = new Array(newItems.length)\n    var removed = []\n    var matched = {}\n    var added = []\n    var index\n\n    domNodes = []\n\n    for(var i = 0, l = newItems.length; i < l; ++i) {\n      index = findIndex(items, newItems[i], unique)\n\n      if(index !== -1) {\n        newChildren[i] = children[index]\n        items[index] = children[index] = matched\n      } else {\n        added.push(newChildren[i] = makeChild())\n      }\n\n      domNodes = domNodes.concat(newChildren[i].nodes)\n    }\n\n    for(var i = 0, l = children.length; i < l; ++i) {\n      if(children[i] !== matched) {\n        removed.push(children[i])\n      }\n    }\n\n    children = newChildren.slice()\n    items = newItems.slice()\n    updateChildren(lookups.state)\n    altr.destroy(flatten(removed), root, runUpdates.bind(\n        altr\n      , domNodes\n      , flatten(added)\n    ))\n  }\n\n  function findIndex(items, d, unique) {\n    if(!unique) {\n      return items.indexOf(d)\n    }\n\n    for(var i = 0, l = items.length; i < l; ++i) {\n      if(items[i][unique] === d[unique]) {\n        return i\n      }\n    }\n\n    return -1\n  }\n\n  function makeChild() {\n    return altr.initNodes(template.cloneNode(true).childNodes)\n  }\n\n  function runDomUpdates(children, added) {\n    setChildren.call(this, root, children)\n    altr.runHooks(added, 'insert', root)\n  }\n}\n\nfunction flatten(list) {\n  return list.reduce(function(all, part) {\n    return part.hooks ? all.concat(part.hooks) : all\n  }, [])\n}","module.exports = function raw() {}\n","module.exports = ifTag\n\nfunction ifTag(el, getter, lookups, decorators) {\n  var placeholder = this.document.createComment('altr-if-placeholder')\n  var children = this.initNodes(el.childNodes)\n  var all = children.hooks.concat(decorators)\n  var lastVal = null\n  var hidden = null\n  var first = true\n  var altr = this\n\n  var update = this.batch.add(function(show, origin) {\n    if(!hidden && !show) {\n      el.parentNode.replaceChild(placeholder, el)\n      el._altrPlaceholder = placeholder\n      hidden = true\n    } else if(hidden && show) {\n      placeholder.parentNode.replaceChild(el, placeholder)\n      altr.runHooks(all, 'insert', origin)\n      delete el._altrPlaceholder\n      hidden = false\n    } else if(first) {\n      first = false\n      altr.runHooks(all, 'insert', origin)\n    }\n  })\n\n  lookups.on(getter, toggle, true)\n\n  return {\n      insert: insert\n    , remove: remove\n    , destroy: destroy\n  }\n\n  function destroy(el) {\n    altr.runHooks(children.hooks, 'destroy', el)\n  }\n\n  function toggle(val) {\n    lastVal = val\n\n    if(val) {\n      update(true, el)\n      children.lookups.update(lookups.state)\n    } else {\n      altr.remove(all, el, function() {\n        return update(false, el)\n      })\n    }\n  }\n\n  function insert(el) {\n    if(lastVal) {\n      update(true, el)\n    }\n  }\n\n  function remove(el, done) {\n    if(hidden) {\n      done()\n\n      return update(false)\n    }\n\n    altr.remove(children.hooks, el, function() {\n      update(false)\n      done()\n    })\n  }\n}\n\n","var EE = require('events').EventEmitter\nvar batch = require('batch-queue')\nvar dirtybit = require('dirtybit')\nvar extend = require('extend')\n\nvar templateString = require('./template-string')\nvar elementNode = require('./element-node')\nvar mergeHooks = require('./merge-hooks')\nvar altrExtend = require('./altr-extend')\nvar textNode = require('./text-node')\nvar toString = require('./to-string')\nvar runHooks = require('./run-hooks')\nvar getEl = require('./get-element')\nvar destroy = require('./destroy')\nvar render = require('./render')\nvar remove = require('./remove')\nvar raf = require('./raf')\n\n// dynamic require so it does not make it into the browserify bundle\nvar domModule = 'micro-dom'\n\nmodule.exports = altr\n\naltr.filters = {}\naltr.includes = {}\naltr.decorators = {}\n\naltr.render = render\naltr.addTag = addTag\naltr.include = include\naltr.extend = altrExtend\naltr.addFilter = addFilter\naltr.addDecorator = addDecorator\n\nfunction altr(root, data, options) {\n  if(!(this instanceof altr)) {\n    return new altr(root, data, options)\n  }\n\n  var options = options || {}\n\n  this.filters = extend(\n      false\n    , Object.create(altr.filters)\n    , options.filters || {}\n  )\n\n  this.decorators = extend(\n      false\n    , Object.create(altr.decorators)\n    , options.decorators || {}\n  )\n\n  this.includes = extend(\n      false\n    , Object.create(altr.includes)\n    , options.includes || {}\n  )\n\n  this.root = root\n  this.sync = !!options.sync\n  this.tagRegExp = makeTagRegExp(options.delimiters)\n  this.document = options.doc || global.document || require(domModule).document\n  this.lookups = dirtybit(data, {filters: this.filters})\n\n  this.batch = batch((function() {\n    if(!this.sync) {\n      raf(this.runBatch.bind(this))\n    }\n  }).bind(this))\n\n  if(global.Buffer && root instanceof global.Buffer) {\n    root = root.toString()\n  }\n\n  if(typeof root === 'string') {\n    var temp = this.document.createElement('div')\n\n    temp.innerHTML = root\n    this.root = this.document.createDocumentFragment()\n\n    while(temp.firstChild) {\n      this.root.appendChild(temp.firstChild)\n    }\n  }\n\n  this.children = this.initNodes(this.rootNodes(), this.lookups)\n  this.runHooks(this.children.hooks, 'insert', null)\n  this.runBatch()\n}\n\naltr.prototype = Object.create(EE.prototype)\naltr.prototype.constructor = altr\n\naltr.prototype.templateString = templateString\naltr.prototype.addDecorator = addDecorator\naltr.prototype.mergeHooks = mergeHooks\naltr.prototype.initNodes = initNodes\naltr.prototype.rootNodes = rootNodes\naltr.prototype.addFilter = addFilter\naltr.prototype.runBatch = runBatch\naltr.prototype.toString = toString\naltr.prototype.runHooks = runHooks\naltr.prototype.getElement = getEl\naltr.prototype.include = include\naltr.prototype.destroy = destroy\naltr.prototype.remove = remove\naltr.prototype.into = appendTo\naltr.prototype.update = update\naltr.prototype.tagList = []\naltr.prototype.tags = {}\n\nvar node_handlers = {}\n\nnode_handlers[1] = elementNode\nnode_handlers[3] = textNode\n\nfunction update(data, sync) {\n  this.state = data\n  this.lookups.update(data)\n\n  if(sync || this.sync) {\n    this.runBatch()\n  }\n}\n\nfunction initNodes(_nodes, _lookups, state) {\n  var altr = this\n  var lookups = _lookups || dirtybit(state, {filters: this.filters})\n  var nodes = Array.prototype.slice.call(_nodes)\n  var hooks = nodes.reduce(join, []).filter(Boolean)\n\n  return {hooks: hooks, lookups: lookups, nodes: nodes}\n\n  function join(list, node) {\n    var hooks = initNode.call(altr, lookups, node)\n\n    return hooks ? list.concat(hooks) : list\n  }\n}\n\nfunction initNode(lookups, el) {\n  return node_handlers[el.nodeType] ?\n    node_handlers[el.nodeType].call(this, el, lookups) :\n    el.childNodes && el.childNodes.length ?\n    this.initNodes(lookups, el.childNodes) :\n    null\n}\n\nfunction rootNodes() {\n  return this.root.nodeType === this.document.DOCUMENT_FRAGMENT_NODE ?\n    [].slice.call(this.root.childNodes) :\n    [this.root]\n}\n\nfunction addFilter(name, filter) {\n  this.filters[name] = filter\n}\n\nfunction addTag(attr, tag) {\n  this.prototype.tags[attr] = tag\n  this.prototype.tagList.push({\n      attr: attr\n    , constructor: tag\n  })\n}\n\nfunction appendTo(node) {\n  var rootNodes = this.rootNodes()\n\n  for(var i = 0, l = rootNodes.length; i < l; ++i) {\n    node.appendChild(getEl(rootNodes[i]))\n  }\n}\n\nfunction include(name, template) {\n  return this.includes[name] = template\n}\n\nfunction addFilter(name, fn) {\n  return this.filters[name] = fn\n}\n\nfunction addDecorator(name, fn) {\n  return this.decorators[name] = fn\n}\n\nfunction runBatch() {\n  this.batch.run() && this.emit('update', this.state)\n}\n\nfunction makeTagRegExp(_delimiters) {\n  var delimiters = _delimiters || ['{{', '}}']\n\n  return new RegExp(delimiters[0] + '\\\\s*(.*?)\\\\s*' + delimiters[1])\n}\n","module.exports = templatString\n\nfunction templatString(template, change, lookups) {\n  if(!template.match(this.tagRegExp)) {\n    return\n  }\n\n  var remaining = template\n    , parts = []\n    , hooks = []\n    , index\n    , next\n\n  while(remaining && (next = remaining.match(this.tagRegExp))) {\n    if(index = remaining.indexOf(next[0])) {\n      parts.push(remaining.slice(0, index))\n    }\n\n    parts.push('')\n    remaining = remaining.slice(index + next[0].length)\n    lookups.on(next[1], setPart.bind(this, parts.length - 1))\n  }\n\n  if(remaining) {\n    setPart(parts.length, remaining)\n  }\n\n  function setPart(idx, val) {\n    parts[idx] = val\n\n    change(parts.join(''))\n  }\n}\n","var createDecorators = require('./decorators')\n  , createAttr = require('./attributes')\n\nmodule.exports = createElementNode\n\nfunction createElementNode(el, lookups) {\n  var decorators = []\n  var altr = this\n  var attr\n\n  var attrs = Array.prototype.slice.call(el.attributes)\n  var decorators = []\n  var altr_tags = {}\n  var tags = {}\n\n  for(var i = 0, l = attrs.length; i < l; ++i) {\n    if(altr.tags[attrs[i].name]) {\n      altr_tags[attrs[i].name] = attrs[i].value\n    } else if(altr.decorators[attrs[i].name]) {\n      decorators.push(attrs[i])\n    } else if(!attrs[i].name.lastIndexOf('altr-attr-', 0)) {\n      createAttr.altr.call(this, el, attrs[i], lookups)\n    } else if(!attrs[i].name.lastIndexOf('altr-prop-', 0)) {\n      createAttr.prop.call(this, el, attrs[i], lookups)\n    } else {\n      createAttr.raw.call(this, el, attrs[i], lookups)\n    }\n  }\n\n  var hooks = createDecorators.call(altr, el, decorators, lookups)\n\n  for(var i = 0, l = altr.tagList.length; i < l; ++i) {\n    if(attr = altr_tags[altr.tagList[i].attr]) {\n      return hooks.concat([\n          altr.tagList[i].constructor.call(altr, el, attr, lookups, hooks) || {}\n      ])\n    }\n  }\n\n  return hooks.concat(altr.initNodes(el.childNodes, lookups).hooks)\n}\n","module.exports = merge\n\nfunction merge(children) {\n  var altr = this\n\n  return {\n      insert: each.bind(null, 'insert')\n    , destroy: each.bind(null, 'destroy')\n    , remove: remove\n  }\n\n  function each(type, el) {\n    var nodes = children()\n\n    for(var i = 0, l = nodes.length; i < l; i++) {\n      nodes[i][type] && nodes[i][type](el)\n    }\n  }\n\n  function remove(el, ready) {\n    altr.remove(children(), el, ready)\n  }\n}","var extend = require('extend')\n\nmodule.exports = altrExtend\n\nfunction altrExtend(base, options) {\n  var baseOptions = extend(true, base, options)\n  var altr = this\n\n  extension.render = altr.render.bind(altr, baseOptions)\n  extension.extend = altr.extend.bind(altr)\n  extension.addTag = altr.addTag.bind(altr)\n  extension.include = altr.include.bind(altr)\n  extension.addFilter = altr.addFilter.bind(altr)\n  extension.addDecorator = altr.addDecorator.bind(altr)\n\n  return extension\n\n  function extension(root, state, options) {\n    return new altr(root, state, extend(\n        true\n      , Object.create(baseOptions)\n      , options || {}\n    ))\n  }\n}","module.exports = initTextNode\n\nfunction initTextNode(el, lookups) {\n  this.templateString(\n      el.textContent\n    , this.batch.add(update)\n    , lookups\n  )\n\n  function update(val) {\n    el.textContent = val\n  }\n}\n","module.exports = toString\n\nfunction toString() {\n  return this.rootNodes().map(function(node) {\n    switch(node.nodeType) {\n      case this.document.DOCUMENT_FRAGMENT_NODE:\n      case this.document.COMMENT_NODE: return clone.call(this, node)\n      case this.document.TEXT_NODE: return node.textContent\n      default: return node.outerHTML\n    }\n  }, this).join('')\n\n  function clone(node) {\n    var temp = this.document.createElement('div')\n\n    temp.appendChild(node.cloneNode(true))\n\n    return temp.innerHTML\n  }\n}\n","module.exports = runHooks\n\nfunction runHooks(hooks, type, el) {\n  for(var i = 0, l = hooks.length; i < l; i++) {\n    hooks[i][type] && hooks[i][type](el)\n  }\n}\n","module.exports = get\n\nfunction get(_el) {\n  var el = _el\n\n  while(el && el._altrPlaceholder) {\n    el = el._altrPlaceholder\n\n    if(el === _el) {\n      throw new Error('placeholder circular refference')\n    }\n  }\n\n  return el\n}\n","module.exports = destroy\n\nfunction destroy(children, el, done) {\n  var altr = this\n\n  altr.remove(children, el, function(el) {\n    altr.runHooks(children, 'destroy', el)\n    done()\n  })\n}\n","module.exports = render\n\nfunction render(template, state, el) {\n  if(this.includes[template]) {\n    template = this.includes[template]\n  }\n\n  var instance = this(template)\n\n  instance.update(state || {}, true)\n\n  if(el) {\n    instance.into(el)\n  }\n\n  return instance\n}\n","module.exports = remove\n\nfunction remove(hooks, el, ready) {\n  var remaining = hooks.length\n  var c = 0\n\n  for(var i = 0, l = remaining; i < l; i++) {\n    hooks[i].remove ? hooks[i].remove(el, done) : --remaining\n  }\n\n  if(!remaining) {\n    ready()\n  }\n\n  function done() {\n    if(!--remaining) {\n      remaining = -1\n      ready()\n    }\n  }\n}","module.exports = requestAnimationFrame\n\nfunction requestAnimationFrame(callback) {\n  var raf = global.requestAnimationFrame ||\n    global.webkitRequestAnimationFrame ||\n    global.mozRequestAnimationFrame ||\n    timeout\n\n  return raf(callback)\n\n  function timeout(callback) {\n    return setTimeout(callback, 1000 / 60)\n  }\n}\n","var get = require('./get-element')\n\nmodule.exports = setChildren\n\nfunction setChildren(root, nodes) {\n  var prev = null\n    , el\n\n  for(var i = nodes.length - 1; i >= 0; --i) {\n    el = get(nodes[i])\n    root.insertBefore(el, prev)\n    prev = el\n  }\n\n  while((el = root.firstChild) !== prev) {\n    root.removeChild(el)\n  }\n}\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      }\n      throw TypeError('Uncaught, unspecified \"error\" event.');\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        len = arguments.length;\n        args = new Array(len - 1);\n        for (i = 1; i < len; i++)\n          args[i - 1] = arguments[i];\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    len = arguments.length;\n    args = new Array(len - 1);\n    for (i = 1; i < len; i++)\n      args[i - 1] = arguments[i];\n\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    var m;\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  var ret;\n  if (!emitter._events || !emitter._events[type])\n    ret = 0;\n  else if (isFunction(emitter._events[type]))\n    ret = 1;\n  else\n    ret = emitter._events[type].length;\n  return ret;\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n","module.exports = decorators\n\nfunction decorators(el, attrs, lookups) {\n  var altr = this\n  var hooks = []\n\n  return attrs.map(createDecorator)\n\n  function createDecorator(attr) {\n    var decorator = altr.decorators[attr.name].call(altr, el)\n    var expression = '[' + attr.value + ']'\n\n    if(!decorator) {\n      return\n    }\n\n    var hooks = {insert: decorator.insert, remove: decorator.remove}\n\n    if(decorator.update) {\n      lookups.on(expression, update)\n    }\n\n    hooks.destroy = destroy\n\n    return hooks\n\n    function destroy() {\n      lookups.removeListener(expression, update)\n\n      if(decorator.destroy) {\n        decorator.destroy()\n      }\n    }\n\n    function update(args) {\n      decorator.update.apply(null, args)\n    }\n  }\n}\n","module.exports.raw = rawAttribute\nmodule.exports.altr = altrAttribute\nmodule.exports.prop = altrProperty\n\nfunction rawAttribute(el, attr, lookups) {\n  this.templateString(\n      attr.value\n    , this.batch.add(el.setAttribute.bind(el, attr.name))\n    , lookups\n  )\n}\n\nfunction altrAttribute(el, attr, lookups) {\n  var name = attr.name.slice('altr-attr-'.length)\n\n  lookups.on(attr.value, this.batch.add(update))\n  el.removeAttribute(attr.name)\n\n  function update(val) {\n    if(!val && val !== '' && val !== 0) {\n      return el.removeAttribute(name)\n    }\n\n    el.setAttribute(name, val)\n  }\n}\n\nfunction altrProperty(el, attr, lookups) {\n  var name = attr.name.slice('altr-prop-'.length)\n\n  el.removeAttribute(attr.name)\n  lookups.on(attr.value, this.batch.add(update))\n\n  function update(val) {\n    el[name] = val\n  }\n}\n","module.exports = Batch\n\nfunction Batch(ready, all) {\n  if(!(this instanceof Batch)) {\n    return new Batch(ready, all)\n  }\n\n  this.jobs = []\n  this.all = all\n  this.ready = ready\n  this.queud = false\n  this.run = this.run.bind(this)\n}\n\nBatch.prototype.queue = queue\nBatch.prototype.add = add\nBatch.prototype.run = run\n\nfunction add(fn) {\n  var queued = false\n    , batch = this\n    , self\n    , args\n\n  return queue\n\n  function queue() {\n    args = [].slice.call(arguments)\n    self = this\n\n    if(queued) {\n      return batch.all && batch.ready()\n    }\n\n    queued = true\n    batch.queue(run)\n  }\n\n  function run() {\n    queued = false\n    fn.apply(self, args)\n  }\n}\n\nfunction queue(fn) {\n  this.jobs.push(fn)\n\n  if(this.all || !this.queued) {\n    this.queued = true\n    this.ready(this)\n  }\n}\n\nfunction run() {\n  var jobs = this.jobs\n\n  this.jobs = []\n  this.queued = false\n\n  for(var i = 0, l = jobs.length; i < l; ++i) {\n    jobs[i]()\n  }\n\n  return !!jobs.length\n}\n","var Expression = require('./expression')\r\nvar remove = require('./remove')\r\nvar types = require('./types')\r\nvar parse = require('./parse')\r\nvar split = require('./split')\r\nvar watch = require('./watch')\r\nvar hash = require('./hash')\r\n\r\nmodule.exports = DirtyBit\r\n\r\nfunction DirtyBit(state, options) {\r\n  if(!(this instanceof DirtyBit)) {\r\n    return new DirtyBit(state, options)\r\n  }\r\n\r\n  this.options = options || {}\r\n\r\n  this.partials = {}\r\n  this.state = state || {}\r\n  this.filters = Object.create(this.options.filters || null)\r\n  this.rootKey = this.options.rootKey\r\n\r\n  this.rootExpression = new Expression('this', [], this.state)\r\n\r\n  this.expressions = {}\r\n  this.handlers = {}\r\n  this.handlerList = []\r\n\r\n  this.expressions['this'] = this.rootExpression\r\n  this.rootExpression.removable = false\r\n\r\n  if(this.rootKey) {\r\n    this.expressions[this.rootKey] = this.rootExpression\r\n  }\r\n\r\n  this.updating = false\r\n}\r\n\r\nDirtyBit.prototype.removeListener = remove\r\nDirtyBit.prototype.addFilter = addFilter\r\nDirtyBit.prototype.update = update\r\nDirtyBit.prototype.report = report\r\nDirtyBit.prototype.types = types\r\nDirtyBit.prototype.split = split\r\nDirtyBit.prototype.parse = parse\r\nDirtyBit.prototype.watch = watch\r\nDirtyBit.prototype.hash = hash\r\nDirtyBit.prototype.trim = trim\r\nDirtyBit.prototype.on = on\r\n\r\nDirtyBit.parsed = {}\r\n\r\nfunction update(state) {\r\n  this.state = state\r\n  this.updating = true\r\n  this.rootExpression.change(state)\r\n  this.updating = false\r\n  this.report()\r\n}\r\n\r\nfunction report() {\r\n  var expression\r\n  var lookup\r\n\r\n  for(var i = 0, l = this.handlerList.length; i < l; ++i) {\r\n    lookup = this.handlerList[i]\r\n    expression = this.expressions[lookup]\r\n\r\n    if(!expression.changed) {\r\n      continue\r\n    }\r\n\r\n    for(var j = 0, l2 = this.handlers[lookup].length; j < l2; ++j) {\r\n      this.handlers[lookup][j](expression.value)\r\n    }\r\n\r\n    expression.changed = false\r\n  }\r\n}\r\n\r\nfunction addFilter(name, filter) {\r\n  this.filters[name] = filter\r\n}\r\n\r\nfunction trim(str) {\r\n  return str.replace(/^\\s+|\\s+$/g, '')\r\n}\r\n\r\nfunction on(_lookup, handler) {\r\n  var lookup = this.trim(_lookup)\r\n\r\n  if(this.handlers[lookup]) {\r\n    this.handlers[lookup].push(handler)\r\n\r\n    return handler(this.expressions[lookup].value)\r\n  }\r\n\r\n  this.updating = true\r\n  this.watch(lookup)\r\n  this.handlerList.push(lookup)\r\n  this.handlers[lookup] = [handler]\r\n  this.updating = false\r\n  handler(this.expressions[lookup].value)\r\n}\r\n","var hasOwn = Object.prototype.hasOwnProperty;\nvar toString = Object.prototype.toString;\nvar undefined;\n\nvar isPlainObject = function isPlainObject(obj) {\n\t\"use strict\";\n\tif (!obj || toString.call(obj) !== '[object Object]' || obj.nodeType || obj.setInterval) {\n\t\treturn false;\n\t}\n\n\tvar has_own_constructor = hasOwn.call(obj, 'constructor');\n\tvar has_is_property_of_method = obj.constructor && obj.constructor.prototype && hasOwn.call(obj.constructor.prototype, 'isPrototypeOf');\n\t// Not own constructor property must be Object\n\tif (obj.constructor && !has_own_constructor && !has_is_property_of_method) {\n\t\treturn false;\n\t}\n\n\t// Own properties are enumerated firstly, so to speed up,\n\t// if last one is own, then all properties are own.\n\tvar key;\n\tfor (key in obj) {}\n\n\treturn key === undefined || hasOwn.call(obj, key);\n};\n\nmodule.exports = function extend() {\n\t\"use strict\";\n\tvar options, name, src, copy, copyIsArray, clone,\n\t\ttarget = arguments[0],\n\t\ti = 1,\n\t\tlength = arguments.length,\n\t\tdeep = false;\n\n\t// Handle a deep copy situation\n\tif (typeof target === \"boolean\") {\n\t\tdeep = target;\n\t\ttarget = arguments[1] || {};\n\t\t// skip the boolean and the target\n\t\ti = 2;\n\t} else if (typeof target !== \"object\" && typeof target !== \"function\" || target == undefined) {\n\t\t\ttarget = {};\n\t}\n\n\tfor (; i < length; ++i) {\n\t\t// Only deal with non-null/undefined values\n\t\tif ((options = arguments[i]) != null) {\n\t\t\t// Extend the base object\n\t\t\tfor (name in options) {\n\t\t\t\tsrc = target[name];\n\t\t\t\tcopy = options[name];\n\n\t\t\t\t// Prevent never-ending loop\n\t\t\t\tif (target === copy) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t// Recurse if we're merging plain objects or arrays\n\t\t\t\tif (deep && copy && (isPlainObject(copy) || (copyIsArray = Array.isArray(copy)))) {\n\t\t\t\t\tif (copyIsArray) {\n\t\t\t\t\t\tcopyIsArray = false;\n\t\t\t\t\t\tclone = src && Array.isArray(src) ? src : [];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tclone = src && isPlainObject(src) ? src : {};\n\t\t\t\t\t}\n\n\t\t\t\t\t// Never move original objects, clone them\n\t\t\t\t\ttarget[name] = extend(deep, clone, copy);\n\n\t\t\t\t// Don't bring in undefined values\n\t\t\t\t} else if (copy !== undefined) {\n\t\t\t\t\ttarget[name] = copy;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Return the modified object\n\treturn target;\n};\n\n","module.exports = Expression\r\n\r\nfunction Expression(parsed, deps, value, handler) {\r\n  this.dependents = []\r\n  this.deps = deps\r\n  this.parsed = parsed\r\n  this.changed = false\r\n  this.removable = true\r\n  this.value = value\r\n  this.update = update.bind(this)\r\n  this.handler = handler\r\n\r\n  for(var i = 0, l = deps.length; i < l; ++i) {\r\n    deps[i].dependents.push(this)\r\n  }\r\n}\r\n\r\nExpression.prototype.change = change\r\nExpression.prototype.update = update\r\n\r\nfunction change(val) {\r\n  if(this.value === val && (!this.value || typeof this.value !== 'object')) {\r\n    return\r\n  }\r\n\r\n  this.value = val\r\n  this.changed = true\r\n\r\n  for(var i = 0, l = this.dependents.length; i < l; ++i) {\r\n    this.dependents[i].update()\r\n  }\r\n}\r\n\r\nfunction update() {\r\n  var args = new Array(this.deps.length)\r\n\r\n  for(var i = 0, l = this.deps.length; i < l; ++i) {\r\n    args[i] = this.deps[i].value\r\n  }\r\n\r\n  this.handler.apply(null, args)\r\n}\r\n","var default_pairs = [\r\n    ['(', ')']\r\n  , ['[', ']']\r\n  , ['?', ':']\r\n  , ['\"', '\"', true]\r\n  , [\"'\", \"'\", true]\r\n]\r\n\r\nmodule.exports = split\r\nmodule.exports.pairs = default_pairs\r\n\r\nfunction split(parts, key, all, _pairs) {\r\n  var pairs = _pairs || default_pairs\r\n    , inString = false\r\n    , layers = []\r\n\r\n  for(var i = 0, l = parts.length; i < l; ++i) {\r\n    if(!~parts.indexOf(key)) {\r\n      i = l\r\n\r\n      break\r\n    }\r\n\r\n    if(!layers.length) {\r\n      for(var j = 0, l2 = key.length; j < l2; ++j) {\r\n        if(parts[i + j] !== key[j]) {\r\n          break\r\n        }\r\n      }\r\n\r\n      if(j === key.length) {\r\n        break\r\n      }\r\n    }\r\n\r\n    if(layers.length && layers[layers.length - 1] === parts[i]) {\r\n      inString = false\r\n      layers.pop()\r\n\r\n      continue\r\n    }\r\n\r\n    if(inString) {\r\n      continue\r\n    }\r\n\r\n    for(var j = 0, l2 = pairs.length; j < l2; ++j) {\r\n      if(parts[i] === pairs[j][0]) {\r\n        if(pairs[j][2]) {\r\n          inString = true\r\n        }\r\n\r\n        layers.push(pairs[j][1])\r\n\r\n        break\r\n      }\r\n    }\r\n  }\r\n\r\n  if(layers.length) {\r\n    console.error(\r\n        'Unmatched pair in ' + parts + '. expecting: ' + layers.pop()\r\n    )\r\n  }\r\n\r\n  if(i === parts.length) {\r\n    return [parts]\r\n  }\r\n\r\n  var right = parts.slice(i + key.length)\r\n    , left = parts.slice(0, i)\r\n\r\n  if(!all) {\r\n    return [left, right]\r\n  }\r\n\r\n  return [left].concat(split(right, key, all, pairs))\r\n}\r\n","var Expression = require('./expression')\r\n\r\nmodule.exports = watch\r\n\r\nvar seen = {}\r\n\r\nfunction watch(lookup) {\r\n  var self = this\r\n\r\n  var parsed = seen[lookup] || (seen[lookup] = self.parse(lookup))\r\n  var partials = parsed.partials && Object.keys(parsed.partials)\r\n\r\n  var handler = createHandler.call(self, parsed, change)\r\n\r\n  if(partials) {\r\n    for(var i = 0, l = partials.length; i < l; ++i) {\r\n      self.partials[partials[i]] = parsed.partials[partials[i]]\r\n      getDep.call(self, self.partials[partials[i]])\r\n    }\r\n  }\r\n\r\n  var expression = createExpression.call(self, parsed, handler)\r\n\r\n  self.expressions[lookup] = expression\r\n\r\n  if(expression.handler) {\r\n    expression.update()\r\n  }\r\n\r\n  return expression\r\n\r\n  function change(val) {\r\n    if(self.updating) {\r\n      return expression.change(val)\r\n    }\r\n\r\n    self.updating = true\r\n    expression.change(val)\r\n    self.updating = false\r\n    self.report()\r\n  }\r\n}\r\n\r\nfunction createHandler(parsed, change) {\r\n  var type = this.types.types[parsed.type]\r\n\r\n  if(typeof type === 'function') {\r\n    return type.call(this, change, parsed.options)\r\n  }\r\n\r\n  return null\r\n}\r\n\r\nfunction createExpression(parsed, handler) {\r\n  var deps = parsed.deps ? parsed.deps.map(getDep.bind(this)) : []\r\n  var proxy = parsed.proxy && getDep.call(this, parsed.proxy)\r\n  var expression\r\n\r\n  if(proxy) {\r\n    return expression = new Expression(parsed, [proxy], proxy.value, echo)\r\n  }\r\n\r\n  return new Expression(parsed, deps, parsed.value, handler)\r\n\r\n  function echo(val) {\r\n    expression.change(val)\r\n  }\r\n}\r\n\r\nfunction getDep(_lookup) {\r\n  var lookup = this.trim(_lookup)\r\n\r\n  return this.expressions[lookup] || this.watch(lookup)\r\n}\r\n","module.exports = hash\r\n\r\nfunction hash(str) {\r\n  var val = 0\r\n\r\n  for(var i = 0, len = str.length; i < len; ++i) {\r\n    val = ((val << 5) - val) + str.charCodeAt(i)\r\n    val |= 0\r\n  }\r\n\r\n  return val.toString().replace('-', '_')\r\n}\r\n","module.exports = remove\r\n\r\nfunction remove(_lookup, handler) {\r\n  var lookup = this.trim(_lookup)\r\n  var handlers = this.handlers[lookup]\r\n\r\n  if(!handlers) {\r\n    return\r\n  }\r\n\r\n  var index = handlers.indexOf(handler)\r\n\r\n  if(index < 0) {\r\n    return\r\n  }\r\n\r\n  handlers.splice(index, 1)\r\n\r\n  if(this.handlers[lookup].length) {\r\n    return\r\n  }\r\n\r\n  delete this.handlers[lookup]\r\n  this.handlerList.splice(this.handlerList.indexOf(lookup), 1)\r\n  removeExpression(this, this.expressions[lookup])\r\n}\r\n\r\nfunction removeExpression(self, expression) {\r\n  if(expression.dependents.length || !expression.removable) {\r\n    return\r\n  }\r\n\r\n  delete self.expressions[expression.parsed.lookup]\r\n\r\n  for(var i = 0, l = expression.deps.length, dep; i < l; ++i) {\r\n    dep = expression.deps[i]\r\n    dep.dependents.splice(dep.dependents.indexOf(expression), 1)\r\n    removeExpression(self, dep)\r\n  }\r\n}\r\n","module.exports = parse\r\n\r\nfunction parse(lookup) {\r\n  var val\r\n\r\n  for(var i = 0, l = this.types.order.length; i < l; ++i) {\r\n    val = this.types.types[this.types.order[i]].parse.call(this, lookup)\r\n\r\n    if(val) {\r\n      break\r\n    }\r\n  }\r\n\r\n  val.type = this.types.order[i]\r\n  val.lookup = lookup\r\n\r\n  return val\r\n}\r\n","var brackets = require('./brackets')\r\nvar dot_path = require('./dot-path')\r\nvar filters = require('./filters')\r\nvar partial = require('./partial')\r\nvar ternary = require('./ternary')\r\nvar parens = require('./parens')\r\nvar values = require('./values')\r\nvar binary = require('./binary')\r\nvar unary = require('./unary')\r\nvar list = require('./list')\r\n\r\nmodule.exports.order = [\r\n    'values'\r\n  , 'filters'\r\n  , 'partial'\r\n  , 'parens'\r\n  , 'ternary'\r\n  , 'binary'\r\n  , 'unary'\r\n  , 'brackets'\r\n  , 'list'\r\n  , 'dot_path'\r\n]\r\n\r\nmodule.exports.types = {\r\n    values: values\r\n  , filters: filters\r\n  , partial: partial\r\n  , parens: parens\r\n  , ternary: ternary\r\n  , binary: binary\r\n  , unary: unary\r\n  , brackets: brackets\r\n  , list: list\r\n  , dot_path: dot_path\r\n}\r\n","var has_bracket = /^.*\\S\\[.+\\]$/\r\n\r\nmodule.exports = brackets\r\nmodule.exports.parse = parse\r\n\r\nfunction parse(lookup) {\r\n  if(!has_bracket.test(lookup)) {\r\n    return false\r\n  }\r\n\r\n  var pairs = this.split.pairs.map(function(pair) {\r\n    return [pair[1], pair[0], pair[2]]\r\n  })\r\n\r\n  return {\r\n      deps: this.split(reverse(lookup.slice(0, -1)), '[', false, pairs)\r\n        .map(reverse)\r\n  }\r\n}\r\n\r\nfunction reverse(str) {\r\n  return str.split('').reverse().join('')\r\n}\r\n\r\nfunction brackets(change) {\r\n  return function(inner, root) {\r\n    if(root === null || root === undefined) {\r\n      return change()\r\n    }\r\n\r\n    change(root[inner])\r\n  }\r\n}\r\n","var valid_path = /^(.*)\\.([^.\\s]+)$/\r\n\r\nmodule.exports = create\r\nmodule.exports.parse = parse\r\n\r\nfunction parse(lookup) {\r\n  var parts = lookup.match(valid_path)\r\n\r\n  return parts ?\r\n    {deps: [parts[1]], options: parts[2]} :\r\n    {deps: ['this'], options: lookup}\r\n}\r\n\r\nfunction create(change, key) {\r\n  return function(obj) {\r\n    if(obj === null || obj === undefined) {\r\n      return change()\r\n    }\r\n\r\n    change(obj[key])\r\n  }\r\n}\r\n","var filter_regexp = /^([^\\s(]+)\\((.*)\\)$/\r\n\r\nmodule.exports = create\r\nmodule.exports.parse = parse\r\n\r\nfunction parse(lookup) {\r\n  var parts = lookup.match(filter_regexp)\r\n\r\n  if(!parts) {\r\n    return false\r\n  }\r\n\r\n  return {deps: this.split(parts[2], ',', true), options: parts[1]}\r\n}\r\n\r\nfunction create(change, name) {\r\n  return this.filters[name](change) || function() {\r\n    console.error('could not find filter: ' + name)\r\n  }\r\n}\r\n","var regexp = /^\\{\\{[#_\\w]+\\}\\}$/\r\n\r\nmodule.exports.parse = parse\r\n\r\nfunction parse(lookup) {\r\n  return regexp.test(lookup) ? {proxy: this.partials[lookup]} : false\r\n}\r\n","var ternary_regexp = /^\\s*(.+?)\\s*\\?(.*)\\s*$/\r\n\r\nmodule.exports = create\r\nmodule.exports.parse = parse\r\n\r\nfunction parse(lookup) {\r\n  var parts = lookup.match(ternary_regexp)\r\n\r\n  if(!parts) {\r\n    return false\r\n  }\r\n\r\n  var rest = this.split(parts[2], ':')\r\n\r\n  if(rest.length !== 2) {\r\n    console.error('Unmatched ternary in: ' + lookup)\r\n  }\r\n\r\n  return {deps: [parts[1], rest[0], rest[1]]}\r\n}\r\n\r\nfunction create(change) {\r\n  return function(ok, left, right) {\r\n    change(ok ? left : right)\r\n  }\r\n}\r\n","var parens_regexp = /(^|[^0-9a-zA-Z_$])\\((.*)$/\r\n\r\nmodule.exports.parse = parse\r\n\r\nfunction parse(lookup) {\r\n  var parts = lookup.match(parens_regexp)\r\n\r\n  if(!parts) {\r\n    return false\r\n  }\r\n\r\n  var body = this.split(parts[2], ')')[0]\r\n  var key = '{{paren_' + this.hash(body) + '}}'\r\n  var partials = {}\r\n\r\n  partials[key] = body\r\n\r\n  var patched = lookup.slice(0, lookup.lastIndexOf([parts[2]]) - 1) +\r\n    key + parts[2].slice(body.length + 1)\r\n\r\n  return {proxy: patched, partials: partials}\r\n}\r\n","var string_regexp = /^(?:'((?:[^'\\\\]|(?:\\\\.))*)'|\"((?:[^\"\\\\]|(?:\\\\.))*)\")$/\r\n  , number_regexp = /^(\\d*(?:\\.\\d+)?)$/\r\n\r\nmodule.exports.parse = parse\r\n\r\nvar vals = {\r\n    'true': true\r\n  , 'false': false\r\n  , 'null': null\r\n  , 'undefined': undefined\r\n}\r\n\r\nfunction parse(lookup) {\r\n  if(vals.hasOwnProperty(lookup)) {\r\n    return {value: vals[lookup]}\r\n  }\r\n\r\n  if(number_regexp.test(lookup)) {\r\n    return {value: +lookup}\r\n  }\r\n\r\n  if(string_regexp.test(lookup)) {\r\n    return {value: lookup.slice(1, -1)}\r\n  }\r\n}\r\n","module.exports = create\r\nmodule.exports.parse = parse\r\n\r\nvar tests = []\r\nvar ops = {}\r\n\r\nadd(['|\\\\|'])\r\nadd(['&&'])\r\nadd(['|'])\r\nadd(['^'])\r\nadd(['&'])\r\nadd(['===', '!==', '==', '!='])\r\nadd(['>=', '<=', '>', '<', ' in ', ' instanceof '])\r\n// add(['<<', '>>', '>>>']) //conflics with < and >\r\nadd(['+', '-'])\r\nadd(['*', '/', '%'])\r\n\r\nops['in'] = updateIn\r\nops['instanceof'] = updateInstanceof\r\n\r\nfunction add(list) {\r\n  tests.push(new RegExp('^(.+?)(\\\\' + list.join('|\\\\') + ')(.+)$'))\r\n}\r\n\r\nfunction parse(lookup) {\r\n  var parts\r\n\r\n  for(var i = 0, l = tests.length; i < l; ++i) {\r\n    parts = lookup.match(tests[i])\r\n\r\n    if(parts) {\r\n      break\r\n    }\r\n  }\r\n\r\n  if(!parts) {\r\n    return false\r\n  }\r\n\r\n  return {deps: [parts[1], parts[3]], options: parts[2]}\r\n}\r\n\r\nfunction create(change, op) {\r\n  if(!ops[op]) {\r\n    ops[op] = createOp(op)\r\n  }\r\n\r\n  return ops[op].bind(null, change)\r\n}\r\n\r\nfunction createOp(op) {\r\n  return Function('change, left, right', 'change(left ' + op + ' right)')\r\n}\r\n\r\nfunction updateIn(left, right) {\r\n  return typeof right !== 'undefined' && left in right\r\n}\r\n\r\nfunction updateInstanceof(left, right) {\r\n  return typeof right === 'function' && left instanceof right\r\n}\r\n","module.exports = create\r\nmodule.exports.parse = parse\r\n\r\nvar test = new RegExp('^(\\\\' + ['!', '+', '-', '~'].join('|\\\\') + ')(.+)$')\r\n\r\nvar ops = {}\r\n\r\nfunction parse(lookup) {\r\n  var parts = lookup.match(test)\r\n\r\n  if(!parts) {\r\n    return false\r\n  }\r\n\r\n  return {deps: [parts[2]], options: parts[1]}\r\n}\r\n\r\nfunction create(change, op) {\r\n  if(!ops[op]) {\r\n    ops[op] = create_op(op)\r\n  }\r\n\r\n  return ops[op].bind(null, change)\r\n}\r\n\r\nfunction create_op(op) {\r\n  return Function('change, val', 'change(' + op + 'val)')\r\n}\r\n","var is_list = /^\\[.+\\]$/\r\n\r\nmodule.exports = list\r\nmodule.exports.parse = parse\r\n\r\nfunction parse(lookup) {\r\n  if(!is_list.test(lookup)) {\r\n    return false\r\n  }\r\n\r\n  return {deps: this.split(lookup.slice(1, -1), ',', true)}\r\n}\r\n\r\nfunction list(change) {\r\n  return function() {\r\n    change([].slice.call(arguments))\r\n  }\r\n}\r\n"]}