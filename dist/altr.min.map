{"version":3,"file":"bundle.js","sources":["/Users/michaelhayes/work/altr/node_modules/browserify/node_modules/browser-pack/_prelude.js","/Users/michaelhayes/work/altr/lib/browser.js","/Users/michaelhayes/work/altr/lib/index.js","/Users/michaelhayes/work/altr/lib/tags/placeholder.js","/Users/michaelhayes/work/altr/lib/tags/children.js","/Users/michaelhayes/work/altr/lib/tags/include.js","/Users/michaelhayes/work/altr/lib/tags/html.js","/Users/michaelhayes/work/altr/lib/tags/text.js","/Users/michaelhayes/work/altr/lib/tags/with.js","/Users/michaelhayes/work/altr/lib/tags/for.js","/Users/michaelhayes/work/altr/lib/tags/if.js","/Users/michaelhayes/work/altr/lib/altr.js","/Users/michaelhayes/work/altr/lib/template_string.js","/Users/michaelhayes/work/altr/lib/element_node.js","/Users/michaelhayes/work/altr/lib/text_node.js","/Users/michaelhayes/work/altr/lib/get_element.js","/Users/michaelhayes/work/altr/lib/to_string.js","/Users/michaelhayes/work/altr/lib/replace.js","/Users/michaelhayes/work/altr/lib/render.js","/Users/michaelhayes/work/altr/lib/insert.js","/Users/michaelhayes/work/altr/lib/raf.js","/Users/michaelhayes/work/altr/lib/remove.js","/Users/michaelhayes/work/altr/lib/set_children.js","/Users/michaelhayes/work/altr/node_modules/browserify/node_modules/events/events.js","/Users/michaelhayes/work/altr/node_modules/altr-accessors/index.js","/Users/michaelhayes/work/altr/node_modules/batch-queue/index.js","/Users/michaelhayes/work/altr/node_modules/altr-accessors/lib/operators.js","/Users/michaelhayes/work/altr/node_modules/altr-accessors/lib/create.js","/Users/michaelhayes/work/altr/node_modules/altr-accessors/lib/filter.js","/Users/michaelhayes/work/altr/node_modules/altr-accessors/lib/lookup.js","/Users/michaelhayes/work/altr/node_modules/altr-accessors/lib/parens.js","/Users/michaelhayes/work/altr/node_modules/altr-accessors/lib/types.js","/Users/michaelhayes/work/altr/node_modules/altr-accessors/lib/arrow.js","/Users/michaelhayes/work/altr/node_modules/altr-accessors/lib/split.js","/Users/michaelhayes/work/altr/node_modules/altr-accessors/node_modules/just-debounce/index.js"],"names":["module","exports","global","altr","require","placeholder","children_tag","include_tag","text_tag","html_tag","with_tag","for_tag","if_tag","addTag","el","accessor","update","val","nodeName","replace","parentNode","_altr_placeholder","this","batch","add","createAccessor","children","nodes","Array","isArray","set_children","call","filter","is_node","bind","nodeType","include","name","innerHTML","includes","updateNodes","childNodes","html","getAttribute","forEach","getElementsByTagName","run","script","fixed","document","createElement","parent","attrs","attributes","i","l","length","setAttribute","value","textContent","insertBefore","removeChild","text","for_handler","root","args","update_children","data","item_data","Object","create","prop","items","new_items","index","new_children","dom_nodes","find_index","unique","make_children","concat","slice","run_updates","d","indexOf","temp","createElementNS","namespaceURI","template","prototype","run_dom_updates","parts","match","for_regexp","Error","split","key","toggle","show","hide","createComment","hidden","sync","doc","EE","dom_module","filters","accessors","raf","runBatch","Buffer","toString","createDocumentFragment","firstChild","appendChild","_update","rootNodes","state","update_nodes","hooks","self","initNodes","init_nodes","flatten","lhs","rhs","map","init_node","Boolean","reduce","node_handlers","root_nodes","DOCUMENT_FRAGMENT_NODE","add_filter","add_tag","attr","tag","tags","tagList","push","constructor","append_to","node","get_el","create_accessor","description","change","fn","run_batch","emit","EventEmitter","template_string","element_node","text_node","render","insert","remove","addFilter","templateString","initNode","getElement","into","set_part","idx","join","hook","TAG","next","remaining","create_element_node","altr_tags","removeAttribute","attr_hook","altr_attr","init_text_node","clone","cloneNode","COMMENT_NODE","TEXT_NODE","outerHTML","old","replaceChild","instance","before","inserted","nextSibling","requestAnimationFrame","callback","timeout","setTimeout","webkitRequestAnimationFrame","mozRequestAnimationFrame","prev","get","_events","_maxListeners","undefined","isFunction","arg","isNumber","isObject","isUndefined","defaultMaxListeners","setMaxListeners","n","isNaN","TypeError","type","er","handler","len","listeners","error","arguments","apply","addListener","listener","m","newListener","warned","console","trace","on","once","g","removeListener","fired","list","position","splice","removeAllListeners","ret","listenerCount","emitter","delay","str","all","write","_out","out","part","create_part","debounce","add_operators","create_accesor","add_filters","add_lookup","add_parens","add_types","add_arrow","types","Batch","ready","jobs","queud","queue","queued","create_ternary","binary","unary","regex","RegExp","create_binary","create_unary","context","ok","not","ternary_regexp","condition","rest","on_data","ctx","check_lhs","check_rhs","is_rhs","unset","changed","Function","finish","build_part","create_filter","filter_regexp","create_lookup","path","lookup","done","obj","result","search","create_parens","_context","parens_regexp","body","count","content","Math","random","create_string_accessor","create_number_accessor","string_regexp","ignore","number_regexp","create_arrow","right","left","_pairs","pairs","layers","j","l2","pop","at_start","guarantee","clear","clearTimeout"],"mappings":"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","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error(\"Cannot find module '\"+o+\"'\")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","module.exports = global.altr = require('./index')\n","var placeholder = require('./tags/placeholder')\n  , children_tag = require('./tags/children')\n  , include_tag = require('./tags/include')\n  , text_tag = require('./tags/text')\n  , html_tag = require('./tags/html')\n  , with_tag = require('./tags/with')\n  , for_tag = require('./tags/for')\n  , if_tag = require('./tags/if')\n  , altr = require('./altr')\n\nmodule.exports = altr\n\naltr.addTag('altr-placeholder', placeholder)\naltr.addTag('altr-children', children_tag)\naltr.addTag('altr-include', include_tag)\naltr.addTag('altr-text', text_tag)\naltr.addTag('altr-html', html_tag)\naltr.addTag('altr-with', with_tag)\naltr.addTag('altr-for', for_tag)\naltr.addTag('altr-if', if_tag)\n","module.exports = placeholder\n\nfunction placeholder(el, accessor) {\n  var altr = this\n\n  return this.batch.add(this.createAccessor(accessor, update))\n\n  function update(val) {\n    if(!val.nodeName) {\n      return\n    }\n\n    altr.replace(el.parentNode, val, el)\n    el._altr_placeholder = val\n    el = val\n  }\n}\n","var set_children = require('../set_children')\n\nmodule.exports = children\n\nfunction children(el, accessor) {\n  return this.batch.add(this.createAccessor(accessor, update.bind(this)))\n\n  function update(val) {\n    var nodes = Array.isArray(val) ? val : [val]\n\n    set_children.call(this, el, nodes.filter(is_node))\n  }\n}\n\nfunction is_node(el) {\n  return el && el.nodeType\n}\n","module.exports = include\n\nfunction include(el, name) {\n  el.innerHTML = this.includes[name]\n\n  return this.updateNodes(el.childNodes)\n}\n","module.exports = html\n\nfunction html(el, accessor) {\n  return this.batch.add(this.createAccessor(accessor, update))\n\n  function update(val) {\n    el.innerHTML = typeof val === 'undefined' ? '' : val\n\n    if(el.getAttribute('altr-run-scripts')) {\n      [].forEach.call(el.getElementsByTagName('script'), run)\n    }\n  }\n}\n\nfunction run(script) {\n  var fixed = document.createElement('script')\n    , parent = script.parentNode\n    , attrs = script.attributes\n    , src\n\n  for(var i = 0, l = attrs.length; i < l; ++i) {\n    fixed.setAttribute(attrs[i].name, attrs[i].value)\n  }\n\n  fixed.textContent = script.textContent\n  parent.insertBefore(fixed, script)\n  parent.removeChild(script)\n}\n","module.exports = text\n\nfunction text(el, accessor) {\n  return this.batch.add(this.createAccessor(accessor, update))\n\n  function update(val) {\n    el.textContent = typeof val === 'undefined' ? '' : val\n  }\n}\n","module.exports = with_tag\n\nfunction with_tag(el, accessor) {\n  var update = this.updateNodes(el.childNodes)\n\n  return update ? this.createAccessor(accessor, update) : null\n}\n","var set_children = require('../set_children')\n  , for_regexp = /^(.*?)\\s+in\\s+(.*$)/\n\nmodule.exports = for_handler\n\nfunction for_handler(root, args) {\n  var parts = args.match(for_regexp)\n    , template = root.innerHTML\n    , dom_nodes = []\n    , children = []\n    , altr = this\n    , items = []\n\n  if(!parts) {\n    throw new Error('invalid for tag: ' + args)\n  }\n\n  root.innerHTML = ''\n\n  var unique = parts[1].split(':')[1]\n    , prop = parts[1].split(':')[0]\n    , key = parts[2]\n\n  var run_updates = this.batch.add(run_dom_updates)\n\n  return altr.createAccessor(key, update)\n\n  function update_children(data) {\n    var item_data\n\n    for(var i = 0, l = children.length; i < l; ++i) {\n      item_data = Object.create(data)\n      item_data[prop] = items[i]\n      item_data['$index'] = i\n\n      children[i].update && children[i].update(item_data)\n    }\n  }\n\n  function update(new_items, data) {\n    if(!Array.isArray(new_items)) {\n      new_items = []\n    }\n\n    var new_children = new Array(new_items.length)\n      , index\n\n    dom_nodes = []\n\n    for(var i = 0, l = new_items.length; i < l; ++i) {\n      index = find_index(items, new_items[i], unique)\n\n      if(index !== -1) {\n        new_children[i] = children[index]\n        items[index] = {}\n      } else {\n        new_children[i] = make_children()\n      }\n\n      dom_nodes = dom_nodes.concat(new_children[i].dom_nodes)\n    }\n\n    children = new_children.slice()\n    items = new_items.slice()\n    run_updates.call(altr)\n    update_children(data)\n  }\n\n  function find_index(items, d, unique) {\n    if(!unique) {\n      return items.indexOf(d)\n    }\n\n    for(var i = 0, l = items.length; i < l; ++i) {\n      if(items[i][unique] === d[unique]) {\n        return i\n      }\n    }\n\n    return -1\n  }\n\n  function make_children() {\n    var temp = altr.document.createElementNS(root.namespaceURI, 'div')\n      , dom_nodes\n      , update\n\n    temp.innerHTML = template\n\n    dom_nodes = Array.prototype.slice.call(temp.childNodes)\n    update = altr.updateNodes(dom_nodes)\n\n    return {\n        dom_nodes: dom_nodes\n      , update: update\n    }\n  }\n\n  function run_dom_updates() {\n    set_children.call(this, root, dom_nodes)\n  }\n}\n","module.exports = if_tag\n\nfunction if_tag(el, accessor) {\n  var placeholder = this.document.createComment('altr-if-placeholder')\n    , update_children = this.updateNodes(el.childNodes)\n    , hidden = null\n    , altr = this\n\n  var hide = this.batch.add(function() {\n    var parent = el.parentNode\n\n    if(!hidden) {\n      altr.replace(el.parentNode, placeholder, el)\n      el._altr_placeholder = placeholder\n      hidden = true\n    }\n  })\n\n  var show = this.batch.add(function() {\n    if(hidden) {\n      altr.replace(placeholder.parentNode, el, placeholder)\n      delete el._altr_placeholder\n      hidden = false\n    }\n  })\n\n  return this.createAccessor(accessor, toggle)\n\n  function toggle(val, data) {\n    if(!val) {\n      return hide()\n    }\n\n    show()\n    update_children && update_children(data)\n  }\n}\n","var accessors = require('altr-accessors')\n  , EE = require('events').EventEmitter\n  , batch = require('batch-queue')\n\nvar template_string = require('./template_string')\n  , element_node = require('./element_node')\n  , text_node = require('./text_node')\n  , get_el = require('./get_element')\n  , toString = require('./to_string')\n  , replace = require('./replace')\n  , render = require('./render')\n  , insert = require('./insert')\n  , remove = require('./remove')\n  , raf = require('./raf')\n\nvar dom_module = 'micro-dom'\n\naltr.filters = {}\naltr.includes = {}\naltr.render = render\naltr.addTag = add_tag\naltr.include = include\naltr.addFilter = add_filter\n\nmodule.exports = altr\n\nfunction altr(root, data, sync, doc) {\n  if(!(this instanceof altr)) {\n    return new altr(root, data, sync, doc)\n  }\n\n  EE.call(this)\n  this.sync = !!sync\n  this.root = root\n  this.document = doc || global.document || require(dom_module).document\n  this.filters = Object.create(altr.filters)\n  this.includes = Object.create(altr.includes)\n  this.accessors = accessors(this.filters, false)\n  this.batch = batch((function() {\n    if(!this.sync) {\n      raf(this.runBatch.bind(this))\n    }\n  }).bind(this))\n\n  if(global.Buffer && root instanceof global.Buffer) {\n    root = root.toString()\n  }\n\n  if(typeof root === 'string') {\n    var temp = this.document.createElement('div')\n\n    temp.innerHTML = root\n    this.root = this.document.createDocumentFragment()\n\n    while(temp.firstChild) {\n      this.root.appendChild(temp.firstChild)\n    }\n  }\n\n  this._update = this.updateNodes(this.rootNodes())\n\n  if(data) {\n    this.update(data, true)\n  }\n}\n\naltr.prototype = Object.create(EE.prototype)\naltr.prototype.constructor = altr\n\naltr.prototype.templateString = template_string\naltr.prototype.createAccessor = create_accessor\naltr.prototype.updateNodes = update_nodes\naltr.prototype.initNodes = init_nodes\naltr.prototype.rootNodes = root_nodes\naltr.prototype.addFilter = add_filter\naltr.prototype.runBatch = run_batch\naltr.prototype.initNode = init_node\naltr.prototype.toString = toString\naltr.prototype.getElement = get_el\naltr.prototype.include = include\naltr.prototype.replace = replace\naltr.prototype.into = append_to\naltr.prototype.update = update\naltr.prototype.insert = insert\naltr.prototype.remove = remove\naltr.prototype.tagList = []\naltr.prototype.tags = {}\n\nvar node_handlers = {}\n\nnode_handlers[1] = element_node\nnode_handlers[3] = text_node\n\nfunction update(data, sync) {\n  this.state = data\n  this._update(data)\n\n  if(sync || this.sync) {\n    this.runBatch()\n  }\n}\n\nfunction update_nodes(nodes) {\n  var hooks = this.initNodes(nodes)\n    , self = this\n\n  return hooks.length ? update : null\n\n  function update(data) {\n    for(var i = 0, l = hooks.length; i < l; ++i) {\n      hooks[i].call(self, data)\n    }\n  }\n}\n\nfunction init_nodes(nodes, list) {\n  var hooks = [].slice.call(nodes)\n    .map(init_node.bind(this))\n    .filter(Boolean)\n    .reduce(flatten, [])\n\n  return hooks\n\n  function flatten(lhs, rhs) {\n    return lhs.concat(rhs)\n  }\n}\n\nfunction init_node(el) {\n  return node_handlers[el.nodeType] ?\n    node_handlers[el.nodeType].call(this, el) :\n    el.childNodes && el.childNodes.length ?\n    this.initNodes(el.childNodes) :\n    null\n}\n\nfunction root_nodes() {\n  return this.root.nodeType === this.document.DOCUMENT_FRAGMENT_NODE ?\n    [].slice.call(this.root.childNodes) :\n    [this.root]\n}\n\nfunction add_filter(name, filter) {\n  altr.filters[name] = filter\n}\n\nfunction add_tag(attr, tag) {\n  altr.prototype.tags[attr] = tag\n  altr.prototype.tagList.push({\n      attr: attr\n    , constructor: tag\n  })\n}\n\nfunction append_to(node) {\n  var root_nodes = this.rootNodes()\n\n  for(var i = 0, l = root_nodes.length; i < l; ++i) {\n    node.appendChild(get_el(root_nodes[i]))\n  }\n}\n\nfunction include(name, template) {\n  return this.includes[name] = template\n}\n\nfunction create_accessor(description, change) {\n  return this.accessors.create(description, change, false)\n}\n\nfunction add_filter(name, fn) {\n  return this.filters[name] = fn\n}\n\nfunction run_batch() {\n  this.batch.run() && this.emit('update', this.state)\n}\n","var TAG = /{{\\s*(.*?)\\s*}}/\n\nmodule.exports = template_string\n\nfunction template_string(template, change) {\n  if(!template.match(TAG)) {\n    return\n  }\n\n  var remaining = template\n    , parts = []\n    , hooks = []\n    , timer\n    , index\n    , next\n\n  while(remaining && (next = remaining.match(TAG))) {\n    if(index = remaining.indexOf(next[0])) {\n      parts.push(remaining.slice(0, index))\n    }\n\n    parts.push('')\n    remaining = remaining.slice(index + next[0].length)\n    hooks.push(\n        this.createAccessor(next[1], set_part.bind(this, parts.length - 1))\n    )\n  }\n\n  parts.push(remaining)\n\n  return update\n\n  function set_part(idx, val) {\n    parts[idx] = val\n    change(parts.join(''))\n  }\n\n  function update(data) {\n    hooks.forEach(function(hook) {\n      hook(data)\n    })\n  }\n}\n","module.exports = create_element_node\n\nfunction create_element_node(el) {\n  var altr_tags = {}\n    , altr = this\n    , hooks = []\n    , attr\n\n  var attrs = Array.prototype.filter.call(el.attributes, function(attr) {\n    return altr.tags[attr.name] ?\n      (altr_tags[attr.name] = attr.value) && false :\n      true\n  })\n\n  attrs.forEach(function(attr) {\n    var value = attr.value\n      , name = attr.name\n      , attr_hook\n      , altr_attr\n\n    if(altr_attr = !name.indexOf('altr-attr-')) {\n      name = attr.name.slice('altr-attr-'.length)\n      el.removeAttribute(attr.name)\n    }\n\n    attr_hook = altr_attr ?\n      altr.createAccessor(value, altr.batch.add(update)) :\n      altr.templateString(\n          value\n        , altr.batch.add(el.setAttribute.bind(el, name))\n      )\n\n    if(attr_hook) {\n      hooks.push(attr_hook)\n    }\n\n    function update(val) {\n      if(!val && val !== '' && val !== 0) {\n        return el.removeAttribute(name)\n      }\n\n      if(val === true) {\n        return el.setAttribute(name, '')\n      }\n\n      el.setAttribute(name, val)\n    }\n  })\n\n  for(var i = 0, l = altr.tagList.length; i < l; ++i) {\n    if(attr = altr_tags[altr.tagList[i].attr]) {\n      hooks.push(altr.tagList[i].constructor.call(altr, el, attr))\n\n      return hooks\n    }\n  }\n\n  return hooks.concat(altr.initNodes(el.childNodes))\n}\n","module.exports = init_text_node\n\nfunction init_text_node(el) {\n  var hook = this.templateString(el.textContent, this.batch.add(update))\n\n  return hook ? [hook] : null\n\n  function update(val) {\n    el.textContent = val\n  }\n}\n","module.exports = get_el\n\nfunction get_el(el) {\n  while(el && el._altr_placeholder) {\n    el = el._altr_placeholder\n  }\n\n  return el\n}\n","module.exports = toString\n\nfunction toString() {\n  return this.rootNodes().map(function(node) {\n    switch(node.nodeType) {\n      case this.document.DOCUMENT_FRAGMENT_NODE:\n      case this.document.COMMENT_NODE: return clone.call(this, node)\n      case this.document.TEXT_NODE: return node.textContent\n      default: return node.outerHTML\n    }\n  }, this).join('')\n\n  function clone(node) {\n    var temp = this.document.createElement('div')\n\n    temp.appendChild(node.cloneNode())\n\n    return temp.innerHTML\n  }\n}\n","module.exports = replace\n\nfunction replace(parent, el, old) {\n  parent.replaceChild(el, old)\n  this.emit('replace', el, old, parent)\n  this.emit('insert', el, parent)\n  this.emit('remove', old, parent)\n}\n","module.exports = render\n\nfunction render(template, state, el) {\n  if(this.includes[template]) {\n    template = this.includes[template]\n  }\n\n  var instance = this(template)\n\n  instance.update(state || {}, true)\n\n  if(el) {\n    instance.into(el)\n  }\n\n  return instance\n}\n","module.exports = insert\n\nfunction insert(parent, el, before) {\n  var inserted = el.parentNode !== parent\n\n  before = before || null\n\n  if(inserted || el.nextSibling !== before) {\n    parent.insertBefore(el, before)\n  }\n\n  if(inserted) {\n    this.emit('insert', el, parent)\n  }\n}\n","module.exports = requestAnimationFrame\n\nfunction requestAnimationFrame(callback) {\n  var raf = global.requestAnimationFrame ||\n    global.webkitRequestAnimationFrame ||\n    global.mozRequestAnimationFrame ||\n    timeout\n\n  return raf(callback)\n\n  function timeout(callback) {\n    return setTimeout(callback, 1000 / 60)\n  }\n}\n","module.exports = remove\n\nfunction remove(parent, el) {\n  parent.removeChild(el)\n  this.emit('remove', el, parent)\n}\n","var get = require('./get_element')\n\nmodule.exports = set_children\n\nfunction set_children(root, nodes) {\n  var prev = null\n    , el\n\n  for(var i = nodes.length - 1; i >= 0; --i) {\n    el = get(nodes[i])\n    this.insert(root, el, prev)\n    prev = el\n  }\n\n  while((el = root.firstChild) !== prev) {\n    this.remove(root, el)\n  }\n}\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      } else {\n        throw TypeError('Uncaught, unspecified \"error\" event.');\n      }\n      return false;\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        len = arguments.length;\n        args = new Array(len - 1);\n        for (i = 1; i < len; i++)\n          args[i - 1] = arguments[i];\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    len = arguments.length;\n    args = new Array(len - 1);\n    for (i = 1; i < len; i++)\n      args[i - 1] = arguments[i];\n\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    var m;\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  var ret;\n  if (!emitter._events || !emitter._events[type])\n    ret = 0;\n  else if (isFunction(emitter._events[type]))\n    ret = 1;\n  else\n    ret = emitter._events[type].length;\n  return ret;\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n","var add_operators = require('./lib/operators')\n  , create_accesor = require('./lib/create')\n  , add_filters = require('./lib/filter')\n  , add_lookup = require('./lib/lookup')\n  , add_parens = require('./lib/parens')\n  , debounce = require('just-debounce')\n  , add_types = require('./lib/types')\n  , add_arrow = require('./lib/arrow')\n  , split = require('./lib/split')\n  , types = []\n\nmodule.exports = accessors\n\n// order is important\nadd_types(types)\nadd_arrow(types)\nadd_filters(types)\nadd_parens(types)\nadd_operators(types)\nadd_lookup(types)\n\naccessors.prototype.create_part = create_accesor\naccessors.prototype.add_filter = add_filter\naccessors.prototype.create = create\naccessors.prototype.types = types\naccessors.prototype.split = split\n\nfunction accessors(filters, delay) {\n  if(!(this instanceof accessors)) {\n    return new accessors(filters, delay)\n  }\n\n  if(!delay && delay !== false) {\n    delay = 0\n  }\n\n  this.delay = delay\n  this.filters = filters || {}\n}\n\nfunction add_filter(name, fn) {\n  this.filters[name] = fn\n}\n\nfunction create(str, change, all) {\n  var part = this.create_part(\n      str\n    , this.delay === false ? update : debounce(change, this.delay, false, true)\n  )\n\n  var sync = false\n    , prev = {}\n    , out\n\n  return write\n\n  function write(data) {\n    var _out = {}\n\n    sync = true\n    out = _out\n    part(data)\n    sync = false\n\n    if(out !== _out) {\n      change.apply(null, out)\n    }\n  }\n\n  function update(val, ctx) {\n    if(!all && typeof val !== 'object' && val === prev) {\n      return\n    }\n\n    out = [].slice.call(arguments)\n    prev = val\n\n    if(!sync) {\n      change.apply(null, out)\n    }\n  }\n}\n","module.exports = Batch\n\nfunction Batch(ready, all) {\n  if(!(this instanceof Batch)) {\n    return new Batch(ready, all)\n  }\n\n  this.jobs = []\n  this.all = all\n  this.ready = ready\n  this.queud = false\n  this.run = this.run.bind(this)\n}\n\nBatch.prototype.queue = queue\nBatch.prototype.add = add\nBatch.prototype.run = run\n\nfunction add(fn) {\n  var queued = false\n    , batch = this\n    , self\n    , args\n\n  return queue\n\n  function queue() {\n    args = [].slice.call(arguments)\n    self = this\n\n    if(queued) {\n      return batch.all && batch.ready()\n    }\n\n    queued = true\n    batch.queue(run)\n  }\n\n  function run() {\n    queued = false\n    fn.apply(self, args)\n  }\n}\n\nfunction queue(fn) {\n  this.jobs.push(fn)\n\n  if(this.all || !this.queued) {\n    this.queued = true\n    this.ready(this)\n  }\n}\n\nfunction run() {\n  var jobs = this.jobs\n\n  this.jobs = []\n  this.queued = false\n\n  for(var i = 0, l = jobs.length; i < l; ++i) {\n    jobs[i]()\n  }\n\n  return !!this.jobs.length\n}\n","var ternary_regexp = /^\\s*(.+?)\\s*\\?(.*)\\s*$/\n\nmodule.exports = add_operators\n\nfunction add_operators(types) {\n  types.push(create_ternary)\n  types.push(binary(['|\\\\|']))\n  types.push(binary(['&&']))\n  types.push(binary(['|']))\n  types.push(binary(['^']))\n  types.push(binary(['&']))\n  types.push(binary(['===', '!==', '==', '!=']))\n  types.push(binary(['>=', '<=', '>', '<', ' in ', ' instanceof ']))\n  // types.push(binary(['<<', '>>', '>>>'])) //conflics with < and >\n  types.push(binary(['+', '-']))\n  types.push(binary(['*', '/', '%']))\n  types.push(unary(['!', '+', '-', '~']))\n}\n\nfunction binary(list) {\n  var regex = new RegExp(\n      '^\\\\s*(.+?)\\\\s\\*(\\\\' +\n      list.join('|\\\\') +\n      ')\\\\s*(.+?)\\\\s*$'\n  )\n\n  return function(parts, change) {\n    return create_binary.call(this, regex, parts, change)\n  }\n}\n\nfunction unary(list) {\n  var regex = new RegExp(\n      '^\\\\s*(\\\\' +\n      list.join('|\\\\') +\n      ')\\\\s*(.+?)\\\\s*$'\n  )\n\n  return function(parts, change) {\n    return create_unary.call(this, regex, parts, change)\n  }\n}\n\nfunction create_ternary(parts, change) {\n  if(!(parts = parts.match(ternary_regexp))) {\n    return\n  }\n\n  var condition = parts[1]\n    , rest = parts[2]\n    , count = 1\n\n  rest = this.split(rest, ':', [['?', ':'], ['(', ')']])\n\n  if(rest.length !== 2) {\n    throw new Error('Unmatched ternary: ' + parts[0])\n  }\n\n  var not = this.create_part(rest[1], change)\n    , ok = this.create_part(rest[0], change)\n\n  return this.create_part(condition, update)\n\n  function update(val, context) {\n    return val ? ok(context) : not(context)\n  }\n}\n\nfunction create_binary(regex, parts, change) {\n  if(!(parts = parts.match(regex))) {\n    return\n  }\n\n  var check_lhs = this.create_part(parts[1], update.bind(null, false))\n    , check_rhs = this.create_part(parts[3], update.bind(null, true))\n    , unset = {}\n\n  var lhs = unset\n    , rhs = unset\n\n  var changed = Function(\n      'change, lhs, rhs'\n    , 'return change(lhs ' + parts[2] + ' rhs)'\n  ).bind(null, change)\n\n  return on_data\n\n  function on_data(data, ctx) {\n    check_lhs(data, ctx)\n    check_rhs(data, ctx)\n  }\n\n  function update(is_rhs, val) {\n    is_rhs ? rhs = val : lhs = val\n\n    if(lhs === unset || rhs === unset) {\n      return\n    }\n\n    changed(lhs, rhs)\n  }\n}\n\nfunction create_unary(regex, parts, change) {\n  if(!(parts = parts.match(regex))) {\n    return\n  }\n\n  var changed = Function(\n      'change, val'\n    , 'return change(' + parts[1] + 'val)'\n  ).bind(null, change)\n\n  return this.create_part(parts[2], changed)\n}\n","module.exports = accessor\n\nfunction accessor(key, change) {\n  var part = build_part.call(this, key, finish.bind(this))\n    , context\n\n  return call\n\n  function call(val, ctx) {\n    part(val, context = ctx || val)\n  }\n\n  function finish(val, ctx) {\n    change.call(this, val, typeof ctx === 'undefined' ? ctx : context)\n  }\n}\n\nfunction build_part(part, change) {\n  var accessor\n\n  for(var i = 0, l = this.types.length; i < l; ++i) {\n    if(accessor = this.types[i].call(this, part, change)) {\n      return accessor\n    }\n  }\n}\n","var filter_regexp = /^\\s*([^\\s(]+)\\((.*)\\)\\s*$/\n\nmodule.exports = add_filter\n\nfunction add_filter(types) {\n  types.push(create_filter)\n}\n\nfunction create_filter(parts, change) {\n  if(!(parts = parts.match(filter_regexp))) {\n    return\n  }\n\n  var filter = this.filters[parts[1]]\n\n  if(!filter) {\n    throw new Error('could not find filter: ' + parts[1])\n  }\n\n  return filter.call(this, this.split(parts[2], ',', null, null, true), change)\n}\n","module.exports = add_lookup\n\nfunction add_lookup(types) {\n  types.push(create_lookup)\n}\n\nfunction create_lookup(path, change) {\n  if(!path.indexOf('$data')) {\n    path = path.slice('$data.'.length)\n\n    if(!path) {\n      return change\n    }\n  }\n\n  return lookup(path.match(/\\s*(.*[^\\s])\\s*/)[1], change)\n}\n\nfunction lookup(path, done) {\n  var parts = path ? path.split('.') : []\n\n  return function(obj, ctx) {\n    var result = search(obj, parts)\n\n    if(typeof result === 'undefined' && ctx) {\n      result = search(ctx, parts)\n    }\n\n    done(result, ctx)\n  }\n}\n\nfunction search(obj, parts) {\n  for(var i = 0, l = parts.length; obj && i < l; ++i) {\n    obj = obj[parts[i]]\n  }\n\n  if(i === l) {\n    return obj\n  }\n}\n","var parens_regexp = /^\\s*\\((.*)$/\n\nmodule.exports = add_parens\n\nfunction add_parens(types) {\n  types.push(create_parens)\n}\n\nfunction create_parens(parts, change) {\n  if(!(parts = parts.match(parens_regexp))) {\n    return\n  }\n\n  var body = parts[1]\n    , count = 1\n\n  for(var i = 0, l = body.length; i < l; ++i) {\n    if(body[i] === ')') {\n      --count\n    } else if(body[i] === '(') {\n      ++count\n    }\n\n    if(!count) {\n      break\n    }\n  }\n\n  if(!i || i === l) {\n    throw new Error('Unmatched parens: ' + parts[0])\n  }\n\n  var content =  this.create_part(body.slice(0, i), update)\n    , key = 'paren_' + Math.random().toString(16).slice(2)\n\n  var template = this.create_part(key + body.slice(i + 1), change)\n\n  return content\n\n  function update(val, _context) {\n    var context = Object.create(typeof _context === 'object' ? _context : null)\n\n    context[key] = val\n    template(context, _context)\n  }\n}\n","var string_regexp = /^\\s*(?:'((?:[^'\\\\]|(?:\\\\.))*)'|\"((?:[^\"\\\\]|(?:\\\\.))*)\")\\s*$/\n  , number_regexp = /^\\s*(\\d*(?:\\.\\d+)?)\\s*$/\n\nmodule.exports = add_types\n\nfunction add_types(types) {\n  types.push(create_string_accessor)\n  types.push(create_number_accessor)\n}\n\nfunction create_string_accessor(parts, change) {\n  if(!(parts = parts.match(string_regexp))) {\n    return\n  }\n\n  var val = parts[1] || parts[2] || ''\n\n  return function(ignore, context) {\n    change(val, context)\n  }\n}\n\nfunction create_number_accessor(parts, change) {\n  if(!(parts = parts.match(number_regexp))) {\n    return\n  }\n\n  var val = +parts[1]\n\n  return function(ignore, context) {\n    change(val, context)\n  }\n}\n","module.exports = add_arrow\n\nfunction add_arrow(types) {\n  types.push(create_arrow)\n}\n\nfunction create_arrow(parts, change) {\n  parts = this.split(parts, '->')\n\n  if(parts.length < 2) {\n    return\n  }\n\n  var right = this.create_part(parts[1], change)\n    , left = this.create_part(parts[0], update)\n\n  return left\n\n  function update(val, ctx) {\n    right(val, ctx)\n  }\n}\n","module.exports = split\n\nfunction split(parts, key, _pairs, all) {\n  var pairs = [['(', ')']]\n    , layers = []\n\n  pairs = _pairs || pairs\n\n  for(var i = 0, l = parts.length; i < l; ++i) {\n    if(!layers.length) {\n      for(var j = 0, l2 = key.length; j < l2; ++j) {\n        if(parts[i + j] !== key[j]) {\n          break\n        }\n      }\n\n      if(j === key.length) {\n        break\n      }\n    }\n\n    if(layers.length && layers[layers.length - 1] === parts[i]) {\n      layers.pop()\n\n      continue\n    }\n\n    for(var j = 0, l2 = pairs.length; j < l2; ++j) {\n      if(parts[i] === pairs[j][0]) {\n        layers.push(pairs[j][1])\n\n        break\n      }\n    }\n  }\n\n  if(layers.length) {\n    throw new Error(\n      'Unmatched pair in ' + parts + '. expecting: ' + layers.pop()\n    )\n  }\n\n  if(i === parts.length) {\n    return [parts]\n  }\n\n  var right = parts.slice(i + key.length)\n    , left = parts.slice(0, i)\n\n  if(!all) {\n    return [left, right]\n  }\n\n  return [left].concat(split(right, key, pairs, all))\n}\n","module.exports = debounce\n\nfunction debounce(fn, delay, at_start, guarantee) {\n  var timeout\n    , args\n\n  return function() {\n    var self = this\n\n    args = Array.prototype.slice.call(arguments)\n\n    if(timeout && (at_start || guarantee)) {\n      return\n    } else if(!at_start) {\n      clear()\n\n      return timeout = setTimeout(run, delay)\n    }\n\n    timeout = setTimeout(clear, delay)\n    fn.apply(self, args)\n\n    function run() {\n      clear()\n      fn.apply(self, args)\n    }\n\n    function clear() {\n      clearTimeout(timeout)\n      timeout = null\n    }\n  }\n}\n"]}